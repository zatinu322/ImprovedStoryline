<?xml version="1.0" encoding="windows-1251" standalone="yes" ?>
<triggers>

<!-- Игрок выезжает из тоннеля. Игрок ищет Лису, укравшую диск 2.(1). -->
<trigger Name="Start0" active="1">
	<event timeout="0" eventid="GE_TIME_PERIOD" />
	<script>

		if IsQuestTaken("r1m3_LisaWithOberegAndDisk_Quest") and not(IsQuestTaken("d_GetSupportOneOfTheBands1_Quest")) and not( IsQuestComplete("d_GetSupportOneOfTheBands1_Quest"))  then
			local b = GetEntityByName("ToR1M3")
			if b then b:SetProperty("Active",0) end

			SetWeather(0)

			PlayCustomMusic("QuietDialogue02")

			SaveAllToleranceStatus(RS_NEUTRAL)

			CompleteQuestIfTaken( "d_OpenTunel_Quest" )

			local Plf = GetPlayerVehicle()
			local PlfCoor = Plf:GetPosition()

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetGamePositionOnGround( CVector(7780.687, 293.455, 4965.787))
			Plf:SetRotation(Quaternion(0.000, -0.830, -0.001, 0.558))
			Plf:SetExternalPathByName("player_path01")
			Plf:SetCustomControlEnabled( false )

			CreateVehicleEx("r2m1_Bug1","vehNezn",CVector(7620.150, 279.045, 4857.137), 1015)

			local vehNezn = GetEntityByName("vehNezn")
			local vehNeznID = vehNezn:GetId()
			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()

			Fly("Start01_cam01", CINEMATIC_NO_AIM, 0, 5, 1, 0 )
			FlyLinked( "Start01_cam02", PlfID, 10, 0, 0, vehNeznID, nil, nil, nil, nil )
			FlyLinked( "Start01_cam03", PlfID, 50, 0, 0, vehNeznID, nil, nil, nil, nil )
			FlyLinked( "Start01_cam04", PlfID, 7, 0, 1, vehNeznID, nil, nil, nil, nil )
			StartCinematic()
			UpdateCinematic( 1 )

			TActivate("trStart01_cam02")
			TActivate("trStart01_cam03")
			TActivate("trStart01_cam04")
			TActivate("trMsg01")
			TActivate("RolikEnd_Start01")

			AddHistory( "r2_After_Tonnel_00" )
			AddHistory( "r2_Find_Lisa_00" )
			AddFadingMsgId( "fm_history_got" )

			trigger:Deactivate()
		end
	</script>
	</trigger>

	<trigger Name="trStart01_cam02" active="0">
		<event flypath="Start01_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			local vehNezn = GetEntityByName("vehNezn")
			if vehNezn then
				vehNezn:SetSkin(3)
				vehNezn:SetGamePositionOnGround( CVector(7620.150, 279.045, 4857.137))
				vehNezn:SetRotation(Quaternion(-0.009, 0.052, -0.026, 0.998))
				vehNezn:SetExternalPathByName("vehNezn_path01")
			end

			AddCinematicMessage( 23, 1 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trStart01_cam03" active="0">
		<event flypath="Start01_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 24, 1 )
			AddCinematicMessage( 25, 0.1 )
			AddCinematicMessage( 26, 0.1 )
			AddCinematicMessage( 27, 0.1 )
			AddCinematicMessage( 7, 0.1 )
			AddCinematicMessage( 8, 0.1 )
			AddCinematicMessage( 9, 0.1 )
			

			trigger:Deactivate()
		</script>

	</trigger>

	<trigger Name="trMsg01" active="0">
	<event msgid="8" eventid="GE_START_CINEMATIC_MSG" ObjName="Player1" />
		<script>
			PlayCustomMusic("Passage03")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trStart01_cam04" active="0">
		<event flypath="Start01_cam04" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			local vehNezn = GetEntityByName("vehNezn")
			if vehNezn then
				vehNezn:SetExternalPathByName("vehNezn_path02")
			end

			AddCinematicMessage( 10, 0.1 )

			trigger:Deactivate()
		</script>

	</trigger>

	<trigger Name="RolikEnd_Start01" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1100, 1048, RS_ENEMY )

			local vehPlayer = GetPlayerVehicle()
			local PlfCoor = vehPlayer:GetPosition()
			local vehNezn = GetEntityByName("vehNezn")

			if vehNezn then vehNezn:Remove() end

			if vehPlayer then
				vehPlayer:SetExternalPathByName("player_path01")
				vehPlayer:PlaceToEndOfPath("player_path01")
				vehPlayer:SetRotation(Quaternion(0.000, -0.830, -0.001, 0.558))
			end

			TeamCreate("AfterTunnel",1048,CVector(7624.016, 273, 4857.879),{"r2m1_Bug1"}, PlfCoor)
			local vehAfterTunnel = GetEntityByName("AfterTunnel_vehicle_0")
			if vehAfterTunnel then
				vehAfterTunnel:SetSkin(3)
				vehAfterTunnel:setImmortalMode(1)
				SetCameraDirectionToObj(vehAfterTunnel:GetId())
			end

			TActivate( "FIRSTATTACK" )

			TDeactivate("trStart01_cam02")
			TDeactivate("trStart01_cam03")
			TDeactivate("trStart01_cam04")
			TDeactivate("trMsg01")

			local b = GetEntityByName("ToR1M3")
			if b then b:SetProperty("Active",1) end

			TActivate("TheNewSibillaClose")

			trigger:Deactivate()
		</script>
	</trigger>

<!-- Игрок убивает машинку перед тоннелем -->
	<trigger Name="RolikBegin_FIRSTATTACK" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			SetTolerance( 1100, 1048, RS_NEUTRAL )
			SaveAllToleranceStatus(RS_NEUTRAL)

			local vehNezn = GetEntityByName("AfterTunnel_vehicle_0")
			local vehNeznID = vehNezn:GetId()
			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyLinked("Nezn_cam01", PlfID, 11, 1, 1, vehNeznID)
			StartCinematic()

			AddCinematicMessage( 11, 1 )

			TActivate("RolikEnd_FIRSTATTACK")
			TActivate("trFIRSTATTACK_PathOut")
			TDeactivate("FIRSTATTACK")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trFIRSTATTACK_PathOut" active="0">
		<event timeout="5" eventid="GE_TIME_PERIOD" />
		<script>
		local vehNezn = GetEntityByName("AfterTunnel")
			if vehNezn then
				vehNezn:StackOpen()
				vehNezn:SetDestination(CVector(7780.687, 293.455, 4965.787))
				vehNezn:StackClose()
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_FIRSTATTACK" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			local vehAfterTunnel = GetEntityByName("AfterTunnel_vehicle_0")
			if vehAfterTunnel then
				vehAfterTunnel:Remove()
			end
			
			TDeactivate("RolikBegin_FIRSTATTACK")
			TDeactivate("trFIRSTATTACK_PathOut")

			StopPlayingCustomMusic()

			SetCameraBehindPlayerVehicle()

			TakeQuest( "FigureOutWhatsGoingOn_Quest" )

			trigger:Deactivate()
		</script>
	</trigger>

<!-- АНТИМИЛЛИТАРИСТЫ -->
	<!-- Перед битвой с бандитами за караван СНГ -->
	<trigger Name="trBeforeCaravanAM" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="BeforeCaravan_loc" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x - 15
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z - 25

			Plf:SetCustomLinearVelocity(0)
			Plf:SetThrottle(0)

			FlyAround(0.5, 0.1, 25, 9, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage(8807, 1)
	
			TActivate("trBeforeCaravanAMEnd")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trBeforeCaravanAMEnd" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(2455.522, 235.932, 2959.787) )
				vehPlayer:SetRotation(Quaternion(0.005, 0.982, 0.002, -0.191))
			end

			TActivate("ZashitaCaravan")

			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Спасли караван СНГ от бойцов АР -->
	<trigger Name="Zashitacin" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			CreateNewDummyObject( "brick_debris1", "CamTochka", -1, -1, CVector(2442.923, 235.955, 2909.160), Quaternion(0, 0, 0, 0), 1)
			
			local CToch = GetEntityByName("CamTochka")
			local CTochID = CToch:GetId()
			local Plf = GetPlayerVehicle()
			local PlfID = Plf:GetId()

			FlyLinked( "DefendSngMolok_Path1", PlfID, 35, 1, 0, CTochID )
			FlyLinked( "DefendSngMolok_Path2", PlfID, 33, 0, 1, PlfID )
			StartCinematic()
			
			AddCinematicMessage( 135, 0.25 )
			AddCinematicMessage( 136, 0.25 )
			AddCinematicMessage( 137, 0.25 )
			AddCinematicMessage( 138, 0.25 )
			
			TActivate("ZashitacinFade")
			TActivate("ZashitacinCam2")
			TActivate("Zashitacin_End")
			TDeactivate("CaravanSNGTolerance2sec")
			
			GetPlayerVehicle():SetCustomLinearVelocity( 0 )
		    GetPlayerVehicle():SetThrottle( 0 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ZashitacinFade" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetGamePositionOnGround( CVector(2450.560, 235.944, 2930.381))
				vehPlayer:SetRotation(Quaternion(-0.021, -0.984, 0.005, 0.175))
			end

			local vehCar = GetEntityByName("CaravanTuzz_vehicle_0")
			if vehCar then
				vehCar:SetGamePositionOnGround( CVector(2441.203, 235.944, 2903.727))
				vehCar:SetRotation(Quaternion(0.002, -0.195, 0.023, -0.980))
			end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ZashitacinCam2" active="0">
	<event flypath="DefendSngMolok_Path2" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			local CToch = GetEntityByName("CamTochka")
			if CToch then CToch:Remove() end

			local vehCar = GetEntityByName("CaravanTuzz_vehicle_0")
			if vehCar then
				vehCar:SetGamePositionOnGround( CVector(2441.203, 235.944, 2903.727))
				vehCar:SetRotation(Quaternion(0.002, -0.195, 0.023, -0.980))
				vehCar:SetExternalPathByName("MolokovozCaravanAM_path1")
			end

			AddCinematicMessage( 139, 0.25 )
			AddCinematicMessage( 140, 0.25 )
			AddCinematicMessage( 141, 0.25 )
			AddCinematicMessage( 142, 0.25 )
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Zashitacin_End" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()
			
			local carVeh = GetEntityByName("CaravanTuzz_vehicle_0")
			if carVeh then carVeh:Remove() end

			local CToch = GetEntityByName("CamTochka")
			if CToch then CToch:Remove() end
			
			SetTolerance(1100,1016,RS_NEUTRAL)

			TDeactivate("ZashitacinFade")
			TDeactivate("ZashitacinCam2")
			TActivate('TheNewSibillaOpen')

			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Подъехали к тоннелю, охраняемому СНГ/АР -->
	<trigger Name="TUNELFIGHT" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TunnelAttackLocation" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x - 25
			PlfCoor.y = PlfCoor.y + 3
			PlfCoor.z = PlfCoor.z - 5

			FlyAround( 1, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			if QuestStatus("d_FreeTunel_Quest1")==Q_TAKEN then
				AddCinematicMessage( 19, 1)
				belong = 1015
			elseif QuestStatus("Tunnel_Quest1")==Q_TAKEN then
				belong = 1016
			end

			TActivate ("trTunelTeamFighters")
			TActivate ("TUNELFIGHT_ce")

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trTunelTeamFighters" active="0">
 		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			if belong == nil then
				belong = 1002
			end

			TeamCreate("TunelTeamFighters", belong, CVector(7718.427, 287.327, 4945.496), {"r2m1_Fighter01","r2m1_Ural01","r2m1_Fighter01"}, nil, nil, Quaternion(0.036, -0.890, 0.043, 0.452))

			TActivate ("TUNELFIGHTERDEAD")

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="TUNELFIGHT_ce" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			if QuestStatus("Tunnel_Quest1")==Q_TAKEN then
				CompleteQuest("Tunnel_Quest1")

			elseif QuestStatus("d_FreeTunel_Quest1")==Q_TAKEN then
				SetTolerance( 1100, 1015, RS_ENEMY )
				SetTolerance( 1016, 1015, RS_ENEMY )

				CompleteQuest( "d_FreeTunel_Quest1" )
			end

			trigger:Deactivate() 
		</script>
	</trigger>

	<!-- Разбили СНГ у тоннеля -->
	<trigger Name="TUNELFIGHTERDEAD" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="TunelTeamFighters" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x + 25
			PlfCoor.y = PlfCoor.y + 3
			PlfCoor.z = PlfCoor.z + 5

			if QuestStatus("Tunnel_Quest2")==Q_TAKEN then
				FlyAround( 1, 0, 25, 21, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				AddCinematicMessage( 143, 1)
				AddCinematicMessage( 144, 1)

				CompleteQuest( "Tunnel_Quest2" )

			elseif QuestStatus("d_FreeTunel_Quest2")==Q_TAKEN then
				FlyAround( 1, 0, 25, 29, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				AddCinematicMessage( 20, 1)
				AddCinematicMessage( 2012, 0.25)

				CompleteQuest( "d_FreeTunel_Quest2" )
			end

			TActivate ("TUNELFIGHTERDEAD_ce")

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="TUNELFIGHTERDEAD_ce" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			if QuestStatus("FinalBattle_Quest1")==Q_TAKEN then
				TActivate("prebattletr")

			elseif QuestStatus("d_FromTuzzToGelvetcia_Quest")==Q_TAKEN then
				SetTolerance( 1100, 1015, RS_ENEMY )
				SetTolerance( 1016, 1015, RS_ENEMY )
			end
			
			trigger:Deactivate() 
		</script>
	</trigger>

	<!-- Перед битвой у Роторска -->
	<trigger Name="prebattlecin_begin" active="0">
		<event	timeout="0.01"	eventid="GE_TIME_PERIOD" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x + 30
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z + 30

			Plf:SetCustomLinearVelocity(0)
			Plf:SetThrottle(0)

			FlyAround(0.5, 0, 25, 10, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			TActivate("prebattlecin_Fade")
			TActivate("prebattlecin_end")

			AddCinematicMessage( 159, 3 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="prebattlecin_Fade" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			TeamCreate("SNGLeaders",1016,CVector(3898.739, 289.628, 2562.902),{"CoolBelaz", "Ural00", "Cruiser02", "Hunter01", "Scout01"}, nil, nil, Quaternion(-0.010, -0.378, 0.009, 0.926))
			TeamCreate("Antimilit",1083,CVector(3797.348, 278.264, 2653.156),{"r1m1_molokovoz02", "Ural00", "r1m2_hunter02", "Molokovoz02", "Odett_hunter"}, nil, nil, Quaternion(-0.001, -0.980, -0.001, -0.198))
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="prebattlecin_end" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()
			
			local vehOdett = GetEntityByName("Antimilit_vehicle_4")
			if vehOdett then
				vehOdett:setImmortalMode(1)
			end
			
			TActivate("FinalBattleEnd")

			CompleteQuest("FinalBattle_Quest1")

			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Победа над СНГ. Одетт получает ранение. -->
	<trigger Name="OIDRolikBegin" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>
			
			SaveAllToleranceStatus(RS_NEUTRAL)
			
			PlayCustomMusic("Passage05")
			
			Fly("preOIDCam", CINEMATIC_NO_AIM, 0, 9.5, 1, 0 )
			Fly("OIDCam1", CINEMATIC_NO_AIM, 0, 11, 0, 0 )
			if IsQuestItemPresent("quest_medicine_box") then
				Fly("OIDCam2", CINEMATIC_NO_AIM, 0, 23, 0, 1 )
			else
				Fly("OIDCam2", CINEMATIC_NO_AIM, 0, 21.5, 0, 1 )
			end
			StartCinematic()
			
			AddCinematicMessage( 147, 0.1 )
			AddCinematicMessage( 148, 0.1 )
			AddCinematicMessage( 149, 0.1 )
			
			TActivate("OIDRolikFade")
			TActivate("OIDRolikCam1")
			TActivate("OIDRolikCam2")
			TActivate("OIDRolikEnd")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="OIDRolikFade" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			
			CreateVehicleEx("r1m2_hunter02","OdettCar",CVector(3907.163, 280.141, 2785.892), 1083)

			CreateVehicleEx("r1m2_CaravanBug02","FirstB_1",CVector(4078.927, 280.560, 2840.551), 1016)

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomControlEnabled( true )
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetCustomControlEnabled( false )
				vehPlayer:SetGamePositionOnGround( CVector(3883.937, 280.535, 2707.229))
				vehPlayer:SetRotation(Quaternion(0.001, -0.463, 0.004, -0.887))
			end
			
			local vehOdett = GetEntityByName("OdettCar")
			if vehOdett then
				vehOdett:SetRotation(Quaternion(-0.009, -0.860, 0.002, -0.511))
			end
			
			local vehPod = GetEntityByName("FirstB_1")
			if vehPod then
				vehPod:SetRotation(Quaternion(0.003, 0.763, 0.002, -0.646))
				vehPod:SetExternalPathByName("OdettIsDead_path")
			end
			
			TActivate("OdettExplode")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="OdettExplode" active="0">
		<event	timeout="9.5"		eventid="GE_TIME_PERIOD" />
		<script>
			
			PlayCustomMusic("Passage04")
			
			local vehOdett = GetEntityByName("OdettCar")
			if vehOdett then
				vehOdett:AddModifier("hp", "= 0")
			end
			
			local vehPod = GetEntityByName("FirstB_1")
			if vehPod then
				vehPod:AddModifier("hp", "= 0")
			end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="OIDRolikCam1" active="0">
		<event flypath="OIDCam1" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 150, 3 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="OIDRolikCam2" active="0">
		<event flypath="OIDCam2" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			if IsQuestItemPresent("quest_medicine_box") then
				AddCinematicMessage( 151, 1 )
				AddCinematicMessage( 152, 0.1 )
				AddCinematicMessage( 153, 0.1 )
				AddCinematicMessage( 154, 0.1 )
			else
				AddCinematicMessage( 156, 1 )
				AddCinematicMessage( 157, 0.1 )
				AddCinematicMessage( 158, 0.1 )
			end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="OIDRolikEnd" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			
			StopPlayingCustomMusic()
			
			SetCameraBehindPlayerVehicle()
			
			CompleteQuest("FinalBattle_Quest2")
			
			TakeQuest("r2m2_FindLisAfterAxelAndFatherDie_Quest")
			
			CompleteQuest("r2m2_FindLisAfterAxelAndFatherDie_Quest")
			
			local vehOdett = GetEntityByName("OdettCar")
			if vehOdett then
				vehOdett:Remove()
			end
			
			local vehPod = GetEntityByName("FirstB_1")
			if vehPod then
				vehPod:Remove()
			end
						
			local vehOdett = GetEntityByName("Antimilit_vehicle_4")
			if vehOdett then
				vehOdett:Remove()
			end
			
			if IsQuestItemPresent("quest_medicine_box") then
				RemoveQuestItem("quest_medicine_box")
				AddFadingMsgByStrIdFormatted( "fm_player_rem_thing", "quest_medicine_box")
			else
				TakeQuest("OdettIsDead_Quest")
				CompleteQuest("OdettIsDead_Quest")
			end

			local towns = {"TheDoubtful", "TheVill2", "TheVill1", "TheUnderAttaks", "TheTuzz", "TheGelvetcia"}
			local len = getn(towns)

			local FlagPos = {CVector(6404.290, 305.196, 3107.355),
							 CVector(3902.071, 306.566, 2507.156), 
							 CVector(3037.489, 238.204, 3449.532), 
							 CVector(3994.093, 322.728, 1362.927), 
							 CVector(2717.923, 318.747, 1878.692), 
							 CVector(6570.422, 343.023, 6980.425)
							}

			local FlagRot = {Quaternion(0.0000, 0.8829, 0.0000, 0.4695), 
							 Quaternion(0.0000, 0.6494, 0.0000, 0.7604), 
							 Quaternion(0.0000, 0.1607, 0.0000, 0.9870), 
							 Quaternion(0.0000, 0.9035, 0.0000, 0.4285), 
							 Quaternion(0.0000, 0.7431, 0.0000, -0.6691), 
							 Quaternion(0,0,0,1)
							}

			for i = 1,len do
				println("Setting belong 1083 to "..towns[i])
				if getObj(towns[i]) then getObj(towns[i]):SetBelong(1083) end
				CreateNewDummyObject("flagshtock", "R2M1Flag"..i, -1, -1, FlagPos, FlagRot, 4)
			end
			
			TActivate("LISAMOVETOGELVFROMR2M2")
			local anmt1 = GetEntityByName("Antimilit_vehicle_0")
			if anmt1 then anmt1:Remove() end
			local anmt2 = GetEntityByName("Antimilit_vehicle_1")
			if anmt2 then anmt2:Remove() end
			local anmt3 = GetEntityByName("Antimilit_vehicle_2")
			if anmt3 then anmt3:Remove() end
			local anmt4 = GetEntityByName("Antimilit_vehicle_3")
			if anmt4 then anmt4:Remove() end
			
			TDeactivate("OIDRolikFade")
			TDeactivate("OIDRolikCam1")
			TDeactivate("OIDRolikCam2")
			TDeactivate("OdettExplode")
			
			trigger:Deactivate()
		</script>
	</trigger>

<!-- СНГ -->
	<!-- Проверить границу -->
	<trigger Name="SERCHSIDELINE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="SideLine" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x - 5
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z - 25

			FlyAround( 1, 0, 25, 12.5, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 13, 1)

			TActivate( "SERCHSIDELINE_ce" )

			CompleteQuest( "d_PatrulSideSNG_Quest" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="SERCHSIDELINE_ce" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			TActivate ("HELPHELPHELP")

			trigger:Deactivate() 
		</script>
	</trigger>

	<!-- Защитить деревню -->
	<trigger Name="HELPHELPHELP" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="VillageAttackLocation" />
		<script>
			TeamCreate("Razboy",1015,CVector(4072, 306, 1765),{"OL_Ural", "Molokovoz02", "Hunter02"}, CVector(4011, 306, 1405), 1)

			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x - 5
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z - 35

			FlyAround( 1, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 14, 1)

			TActivate( "HELPHELPHELP_ce" )

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="HELPHELPHELP_ce" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1100, 1015, RS_ENEMY )
			SetTolerance( 1016, 1015, RS_ENEMY )

			TActivate("RAZBOYINVILLAGEDEAD")

			CompleteQuest( "d_HelpSideVillageSNG_Quest1" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="RAZBOYINVILLAGEDEAD" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="Razboy_vehicle_0" />
		<event eventid="GE_OBJECT_DIE" ObjName="Razboy_vehicle_1" />
		<event eventid="GE_OBJECT_DIE" ObjName="Razboy_vehicle_2" />
		<script>
			TeamCreate("SNGArmy1",1016,CVector(4072, 306, 1765),{"AKF_Cruiser1", "r1m1_molokovoz02"}, CVector(4011, 306, 1405), 1)

			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x + 20
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z - 20

			FlyAround( 1, 0, 25, 13, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 15, 1)
			AddCinematicMessage( 16, 1)

			TActivate( "RAZBOYINVILLAGEDEAD_ce" )

			CompleteQuest( "d_HelpSideVillageSNG_Quest2" )

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="RAZBOYINVILLAGEDEAD_ce" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1100, 1015, RS_ENEMY )
			SetTolerance( 1016, 1015, RS_ENEMY )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<!-- Караван СНГ доехал до Генденбургска -->
	<trigger Name="trCaravanToVill1INPLACE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheVill1_Loc" />
		<script>
			CompleteQuest( "d_SecondVillage_Quest" )

			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x - 25
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z + 5

			FlyAround( 1, 0, 15, 6, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 17, 1)

			TActivate( "trCaravanToVill1INPLACE_ec" )

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trCaravanToVill1INPLACE_ec" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			TActivate( "trCaravanToVill25sec" )
			TActivate( "trCaravanToVill2INPLACE" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<!-- Караван СНГ доехал до Роторска -->
	<trigger Name="trCaravanToVill2INPLACE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheVill2_Loc" />
		<script>
			CompleteQuest( "d_FirstVillage_Quest" )

			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x + 25
			PlfCoor.y = PlfCoor.y + 3
			PlfCoor.z = PlfCoor.z + 5

			FlyAround( 1, 0, 25, 7, PlfCoor, PlfID, 1, 1 )
			StartCinematic()
			AddCinematicMessage( 18, 1)

			TActivate( "trCaravanToVill2INPLACE_ec" )

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trCaravanToVill2INPLACE_ec" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			TActivate( "trCaravanToT5sec" )
			TActivate( "trCaravanToTuzzINPLACE" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<!-- засада на генерала АР -->
	<trigger Name="RolikBegin_TAKEBOSSARLOC" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			local vehSNG = GetEntityByName("SNGTeamFighters_vehicle_1")
			local vehSNGID = vehSNG:GetId()
			local vehSNGCoor = vehSNG:GetPosition()

			local vehAR = GetEntityByName("BossARCar_vehicle_1")
			local vehARID = vehAR:GetId()
			local vehARCoor = vehAR:GetPosition()
			vehARCoor.x = vehARCoor.x + 10
			vehARCoor.y = vehARCoor.y + 50
			vehARCoor.z = vehARCoor.z + 10

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()

			FlyLinked( "TAKEBOSSARLOC_cam01", vehSNGID, 7, 1, 0, PlfID, nil, nil, nil, nil )
			FlyAround( 1, 0, 10, 4, vehARCoor, vehARID, 0, 1 )
			StartCinematic()

			AddCinematicMessage( 21, 0.5 )

			TActivate("RolikEnd_TAKEBOSSARLOC")
			TActivate("trTAKEBOSSARLOC")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trTAKEBOSSARLOC" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(6383.364, 313.205, 1203.239))
				vehPlayer:SetRotation(Quaternion(-0.015, 0.964, 0.015, -0.266))
				vehPlayer:SetExternalPathByName("player_path02")
				vehPlayer:SetThrottle(1)
				vehPlayer:SetCustomLinearVelocity(20)
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_TAKEBOSSARLOC" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1100, 1015, RS_ENEMY )
			SetTolerance( 1016, 1015, RS_ENEMY )

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:PlaceToEndOfPath("player_path02")
			end

			TDeactivate("RolikBegin_TAKEBOSSARLOC")
			TDeactivate("trTAKEBOSSARLOC")

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Разгромили генерала и его охрану -->
	<trigger Name="TAKEBOSSARDEAD" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="BossARCar" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			TActivate( "trVehSTOP" )

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.x = PlfCoor.x + 25
			PlfCoor.y = PlfCoor.y + 3
			PlfCoor.z = PlfCoor.z + 5

			FlyAround( 1, 0, 65, 7.7, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 22, 1)

			TActivate( "TAKEBOSSARDEAD_ce" )

			CompleteQuest( "d_TakeGeneralOfBandits_Quest2" )

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="TAKEBOSSARDEAD_ce" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1100, 1015, RS_ENEMY )
			SetTolerance( 1016, 1015, RS_ENEMY )

			SetCameraBehindPlayerVehicle()

			AddQuestItem("ARGeneral_P")
			AddFadingMsgByStrIdFormatted( "fm_player_add_poput", "ARGeneral_P")

			trigger:Deactivate() 
		</script>
	</trigger>

<!-- Тупиковая концовка при уничтожении каравана СНГ за АМ или СНГ -->
	<trigger Name="CaravDeadEnd1" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)
			
			PlayCustomMusic("IntenseDialogue03")

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomControlEnabled( true )
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetCustomControlEnabled( false )
			end
			
			Fly("CaravDeadCam1", CINEMATIC_NO_AIM, 0, 15, 1, 1 )
			StartCinematic()
			
			AddCinematicMessage( 8804, 1 )

			TActivate("CaravDeadEnd2")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CaravDeadEnd2" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			
			StopPlayingCustomMusic()
			
			SpawnMessageBox( "8805" )
			
			ShowDeathMenu()

			CheckPlayerVehicle()
			
			trigger:Deactivate()
		</script>
	</trigger>

<!-- АР -->
	<!-- Уничтожили караван СНГ -->
	<trigger Name="KARAVANSNGDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="KaravanSNGTill" />
		<script>
			CompleteQuest( "r2m2_FindSNGKaravan" )

			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z + 15

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround( 0.5, 0, 25, 8, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 60, 1 )

			TActivate ("KARAVANSNGDIE_ce")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="KARAVANSNGDIE_ce" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetTolerance( 1100, 1016, RS_ENEMY )

			SetCameraBehindPlayerVehicle()

			local vehCar = GetEntityByName("KaravanSNGTill_vehicle_1_Trailer")
			if vehCar and vehCar:IsAlive() then vehCar:Remove() end

			trigger:Deactivate() 
		</script>
	</trigger>

<!-- Игрок натыкается на Лису возле Гельвеции -->
	<trigger Name="RolikBegin_Lisa" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			PlayCustomMusic("IntenseDialogue02")

			RuleConsole("cinematic_spring_coeff 9")

			local vehLisa = CreateVehicleEx("LisaCar","vehLisa_0",CVector(0, 2000, 0), 1042)
			local vehLisaID = vehLisa:GetId()

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()

			Fly("Lisa_cam01", CINEMATIC_NO_AIM, 0, 3, 1, 0 )
			FlyLinked( "Lisa_cam02", PlfID, 3, 0, 0, vehLisaID, nil, true, nil, nil )
			Fly("Lisa_cam03", CINEMATIC_NO_AIM, 0, 18, 0, 1 )
			StartCinematic()

			TActivate("RolikEnd_Lisa")
			TActivate("trLisa_cam01")
			TActivate("trLisa_cam03")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLisa_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(5980.723, 251.750, 6480.860))
				vehPlayer:SetRotation(Quaternion(-0.020, 0.015, 0.004, 1.000))
				vehPlayer:SetCustomControlEnabled( true )
				vehPlayer:SetExternalPathByName("player_path03")
				vehPlayer:SetCustomControlEnabled( false )
				vehPlayer:SetThrottle(0)
				vehPlayer:SetCustomLinearVelocity(0)
			end

			local vehLisa = GetEntityByName("vehLisa_0")
			if vehLisa then
				vehLisa:SetSkin(2)
				vehLisa:SetGamePositionOnGround(CVector(6110.662, 251.541, 6607.340))
				vehLisa:SetRotation(Quaternion(-0.001, -0.792, -0.000, 0.611))
				vehLisa:SetExternalPathByName("lisa_path01")
				vehLisa:SetThrottle(1)
				vehLisa:SetCustomLinearVelocity(20)
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLisa_cam03" active="0">
		<event flypath="Lisa_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 29, 1 )
			AddCinematicMessage( 30, 1 )

			TActivate( "trLisa_PathOut")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLisa_PathOut" active="0">
		<event timeout="11" eventid="GE_TIME_PERIOD" />
		<script>
			local vehLisa = GetEntityByName("vehLisa_0")
			if vehLisa then
				vehLisa:SetExternalPathByName("lisa_path02")
				vehLisa:SetThrottle(1)
				vehLisa:SetCustomLinearVelocity(5)
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_Lisa" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1100, 1042, RS_ENEMY )

			local vehLisa = GetEntityByName("vehLisa_0")
			if vehLisa then
				vehLisa:Remove()
			end

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:PlaceToEndOfPath("player_path03")
			end

			TeamCreate("LisaInCar",1042,CVector(6032.294, 249, 6565.459),{"LisaCar"})
			local FVehicle = GetEntityByName("LisaInCar_vehicle_0")
			if FVehicle then
				FVehicle:AddItemsToRepository("cooling_system_guns_and_firing_rate_guns", 1)
				FVehicle:SetSkin ( 2 )
				FVehicle:setImmortalMode(1)
				SetCameraDirectionToObj(FVehicle:GetId())
			end

			CompleteQuest( "d_FindLisaInGelvetcia_Quest" )
			CompleteQuest( "r1m3_LisaWithOberegAndDisk_Quest" )

			TActivate ("LISADIED")

			TDeactivate("RolikBegin_Lisa")
			TDeactivate("trLisa_cam01")
			TDeactivate("trLisa_cam03")
			TDeactivate("trLisa_PathOut")

			StopPlayingCustomMusic()

			RuleConsole("cinematic_spring_coeff 0.7")

			trigger:Deactivate()
		</script>
	</trigger>

<!-- игрок побеждает Лису -->
	<trigger Name="RolikBegin_LISADIED" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			PlayCustomMusic("QuietDialogue04")

			SetTolerance( 1100, 1042, RS_ALLY )
			SaveAllToleranceStatus(RS_NEUTRAL)

			Fly("LISADIED_cam01", CINEMATIC_NO_AIM, 0, 6, 1, 0 )
			Fly("LISADIED_cam02", CINEMATIC_NO_AIM, 0, 6, 0, 0 )
			Fly("LISADIED_cam03", CINEMATIC_NO_AIM, 0, 6, 0, 0 )
			Fly("LISADIED_cam04", CINEMATIC_NO_AIM, 0, 10, 0, 0 )
			Fly("LISADIED_cam05", CINEMATIC_NO_AIM, 0, 48.5, 0, 0 )
			Fly("LISADIED_cam06", CINEMATIC_NO_AIM, 0, 9, 0, 0 )
			Fly("LISADIED_cam07", CINEMATIC_NO_AIM, 0, 6, 0, 0 )
			Fly("LISADIED_cam08", CINEMATIC_NO_AIM, 0, 24.5, 0, 0 )
			Fly("LISADIED_cam09", CINEMATIC_NO_AIM, 0, 9.5, 0, 0 )
			Fly("LISADIED_cam10", CINEMATIC_NO_AIM, 0, 16, 0, 1 )
			StartCinematic()

			TActivate("RolikEnd_LISADIED")
			TActivate("trLISADIED_cam01")
			TActivate("trLISADIED_cam02")
			TActivate("trLISADIED_cam03")
			TActivate("trLISADIED_cam04")
			TActivate("trLISADIED_cam05")
			TActivate("trLISADIED_cam06")
			TActivate("trLISADIED_cam07")
			TActivate("trLISADIED_cam08")
			TActivate("trLISADIED_cam09")
			TActivate("trLISADIED_cam10")
			TActivate("trLISADIED_anim01")
			TActivate("trLISADIED_anim02")
			TActivate("trLISADIED_anim03")
			TActivate("trLISADIED_anim04")
			TActivate("trLISADIED_anim05")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local FVehicle = GetEntityByName("LisaInCar_vehicle_0")
			if FVehicle then
				FVehicle:Remove()
			end

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetThrottle(0)
				vehPlayer:SetCustomLinearVelocity(0)
				vehPlayer:SetGamePositionOnGround( CVector(6028.542, 251.587, 6579.957))
				vehPlayer:SetRotation(Quaternion(-0.002, 0.490, -0.002, 0.872))
			end

			CreateVehicleEx("LisaCar","vehLisa_0",CVector(6055.441, 251.229, 6577.806), 1042)
			local vehLisa = GetEntityByName("vehLisa_0")
			if vehLisa then
				vehLisa:SetSkin(2)
				vehLisa:SetRotation(Quaternion(-0.000, -0.807, -0.001, 0.591))
				vehLisa:SetThrottle(0)
				vehLisa:SetCustomLinearVelocity(0)
			end

			CreateNewDummyObject( "dweller_lisa", "humLisa", -1, -1, CVector(6046.292, 249.190, 6583.665), Quaternion(0.000, -0.746, 0.000, 0.666), 0)
			CreateNewDummyObject( "dweller_player", "humPlayer", -1, -1, CVector(6044.253, 249.267, 6583.188), Quaternion(0.000, 0.659, 0.000, 0.752), 0)

			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )

			AddCinematicMessage( 53, 1)

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trLISADIED_cam02" active="0">
		<event flypath="LISADIED_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_RESERVED1)
			getObj("humPlayer"):SetNextForAnimation( AT_RESERVED1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND1)
			getObj("humLisa"):SetNextForAnimation( AT_STAND1, AT_STAND1 )

			AddCinematicMessage( 54, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trLISADIED_cam03" active="0">
		<event flypath="LISADIED_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )

			AddCinematicMessage( 55, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trLISADIED_cam04" active="0">
		<event flypath="LISADIED_cam04" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_RESERVED1)
			getObj("humPlayer"):SetNextForAnimation( AT_RESERVED1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND1)
			getObj("humLisa"):SetNextForAnimation( AT_STAND1, AT_STAND1 )

			AddCinematicMessage( 56, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trLISADIED_cam05" active="0">
		<event flypath="LISADIED_cam05" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )

			AddCinematicMessage( 57, 0.5)
			AddCinematicMessage( 58, 0.5)
			AddCinematicMessage( 59, 0.5)
			AddCinematicMessage( 39, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_anim01" active="0">
		<event msgid="58" eventid="GE_START_CINEMATIC_MSG" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_RESERVED1)
			getObj("humPlayer"):SetNextForAnimation( AT_RESERVED1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND1)
			getObj("humLisa"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_anim02" active="0">
		<event msgid="59" eventid="GE_START_CINEMATIC_MSG" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_anim03" active="0">
		<event msgid="39" eventid="GE_START_CINEMATIC_MSG" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_cam06" active="0">
		<event flypath="LISADIED_cam06" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_RESERVED1)
			getObj("humPlayer"):SetNextForAnimation(AT_RESERVED1, AT_STAND1)
			getObj("humLisa"):SetNodeAction(AT_STAND1)
			getObj("humLisa"):SetNextForAnimation( AT_STAND1, AT_STAND1 )

			AddCinematicMessage( 40, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_cam07" active="0">
		<event flypath="LISADIED_cam07" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )

			AddCinematicMessage( 41, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trLISADIED_cam08" active="0">
		<event flypath="LISADIED_cam08" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_RESERVED1)
			getObj("humPlayer"):SetNextForAnimation(AT_RESERVED1, AT_STAND1)
			getObj("humLisa"):SetNodeAction(AT_STAND1)
			getObj("humLisa"):SetNextForAnimation( AT_STAND1, AT_STAND1 )

			AddCinematicMessage( 42, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trLISADIED_cam09" active="0">
		<event flypath="LISADIED_cam09" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )

			AddCinematicMessage( 45, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="trLISADIED_cam10" active="0">
		<event flypath="LISADIED_cam10" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_RESERVED1)
			getObj("humPlayer"):SetNextForAnimation(AT_RESERVED1, AT_STAND1)
			getObj("humLisa"):SetNodeAction(AT_STAND1)
			getObj("humLisa"):SetNextForAnimation( AT_STAND1, AT_STAND1 )

			AddCinematicMessage( 48, 0.5)
			AddCinematicMessage( 50, 0.5)
			AddCinematicMessage( 61, 0.5)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_anim04" active="0">
		<event msgid="50" eventid="GE_START_CINEMATIC_MSG" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_STAND1)
			getObj("humPlayer"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			getObj("humLisa"):SetNodeAction(AT_STAND2)
			getObj("humLisa"):SetNextForAnimation( AT_STAND2, AT_STAND1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trLISADIED_anim05" active="0">
		<event msgid="61" eventid="GE_START_CINEMATIC_MSG" ObjName="Player1" />
		<script>
			getObj("humPlayer"):SetNodeAction(AT_RESERVED1)
			getObj("humPlayer"):SetNextForAnimation(AT_RESERVED1, AT_STAND1)
			getObj("humLisa"):SetNodeAction(AT_STAND1)
			getObj("humLisa"):SetNextForAnimation( AT_STAND1, AT_STAND1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_LISADIED" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1042, 1005, RS_ENEMY )
			SetTolerance( 1042, 1002, RS_ENEMY )

			CompleteQuest( "d_WinLisaInBattle_Quest" )

			local humLisa = GetEntityByName("humLisa")
			if humLisa then
				humLisa:Remove()
			end

			local humPlayer = GetEntityByName("humPlayer")
			if humPlayer then
				humPlayer:Remove()
			end

			local FVehicle = GetEntityByName("vehLisa_0")
			if FVehicle then
				FVehicle:Remove()
			end

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()

			TeamCreate("LisaInCar",1042,CVector(6017,249,6571),{"LisaCar"}, PlfCoor)
			local FVehicle = GetEntityByName("LisaInCar_vehicle_0")
			if FVehicle then
				FVehicle:SetSkin ( 2 )
				FVehicle:setImmortalMode(1)
			end

			local newControllerId = CreateNewObject {
				prototypeName	= "someNPCMotionController",
				objName		= "LisaCont"
			}

			local newController = GetEntityByID(newControllerId)
			local FVehicle = GetEntityByName("LisaInCar_vehicle_0")
			if FVehicle then
				newController:setVehicleUnderControl(FVehicle)
			end

			TActivate("PARISTUBEREMOVE")

			TDeactivate("RolikBegin_LISADIED")
			TDeactivate("trLISADIED_cam01")
			TDeactivate("trLISADIED_cam02")
			TDeactivate("trLISADIED_cam03")
			TDeactivate("trLISADIED_cam04")
			TDeactivate("trLISADIED_cam05")
			TDeactivate("trLISADIED_cam06")
			TDeactivate("trLISADIED_cam07")
			TDeactivate("trLISADIED_cam08")
			TDeactivate("trLISADIED_cam09")
			TDeactivate("trLISADIED_cam10")
			TDeactivate("trLISADIED_anim01")
			TDeactivate("trLISADIED_anim02")
			TDeactivate("trLISADIED_anim03")
			TDeactivate("trLISADIED_anim04")
			TDeactivate("trLISADIED_anim05")

			StopPlayingCustomMusic()

			SetCameraBehindPlayerVehicle()

			AddQuestItem("quest_disk_1")
			AddQuestItem("quest_disk_2")
			AddQuestItem("quest_key_for_submarine")
			
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_disk_1")
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_disk_2")
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_key_for_submarine")

			trigger:Deactivate()
		</script>
	</trigger>

<!-- Игрок приезжает в Париж, битва с Боссом -->
	<trigger Name="RolikBegin_OPARIS" active="0">
		<event timeout="2" eventid="GE_TIME_PERIOD" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			RuleConsole("cinematic_spring_coeff 1.7")

			CreateNewDummyObject( "brick_debris1", "CamTochka", -1, -1, CVector(2143.560, 232.963, 5914.079), Quaternion(0, 0, 0, 0), 1)

			local CToch = GetEntityByName("CamTochka")
			local CTochID = CToch:GetId()
			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local Cont = GetEntityByName("boss02cont")
			local ContID = Cont:GetId()

			Fly("OPARIS_cam02", CINEMATIC_NO_AIM, 0, 20, 1, 0 )
			FlyLinked("BOSSDIE_cam02", CTochID, 10, 0, 0, ContID, nil, nil, nil, nil )
			Fly("OPARIS_cam04", CINEMATIC_NO_AIM, 0, 4, 0, 1 )
			StartCinematic()

			TActivate("RolikEnd_OPARIS")
			TActivate("trOPARIS_cam01")
			TActivate("trOPARIS_cam03")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trOPARIS_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
		
			PlayCustomMusic("Passage04")

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(2217.584, 235.522, 5753.800))
				vehPlayer:SetRotation(Quaternion(-0.002, -0.266, 0.002, 0.964))
				vehPlayer:SetThrottle(0)
				vehPlayer:SetCustomLinearVelocity(0)
			end

			local vehLisa = GetEntityByName("LisaInCar_vehicle_0")
			if vehLisa then
				vehLisa:SetGamePositionOnGround( CVector(2221.520, 235.525, 5766.983))
				vehLisa:SetRotation(Quaternion(-0.003, -0.498, 0.001, 0.867))
				vehLisa:SetThrottle(0)
				vehLisa:SetCustomLinearVelocity(0)
			end

			trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="trOPARIS_cam03" active="0">
		<event flypath="BOSSDIE_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			PlayCustomMusic("Passage03b")

			local boss02 = GetEntityByName("ParisBoss")
			local BossGo = 1
			if boss02 then
				boss02:NextState()
				SetVar("Go",BossGo)
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_OPARIS" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			PlayCustomMusic("Passage03b")
			
			SetTolerance( 1042, 1002, RS_ENEMY )
			SetTolerance( 1042, 1005, RS_ENEMY )

			RuleConsole("cinematic_spring_coeff 0.7")

			local CToch = GetEntityByName("CamTochka")
			local BossGo = GetVar("Go").AsInt
			if CToch then
				CToch:Remove()
			end

			local boss02 = GetEntityByName("ParisBoss")
			local boss02ID = boss02:GetId()
			if boss02 then
				if BossGo ~= 1 then
					boss02:NextState()
				end
				
				-- by Anton
				boss02:SetJustMovedContainerToBlock()
				
				ShowBossIndicator(boss02ID)
				SetCameraDirectionToObj(boss02ID)
			end

			TDeactivate("RolikBegin_OPARIS")
			TDeactivate("trOPARIS_cam01")
			TDeactivate("trOPARIS_cam03")

			TActivate("RolikBegin_BOSSDIE")

			CompleteQuest( "d_MoveInParis_Quest" )

			TActivate("PARISTUBECREATE")
			TActivate("TRIGGER_OPARISPARISBOSSDIE")

			AllowSave(false)

			trigger:Deactivate()
		</script>
	</trigger>

<!-- Смерть босса -->
	<trigger Name="RolikBegin_BOSSDIE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Boss02Die_Loc" />
		<script>
			PlayCustomMusic("Techno03")

			SaveAllToleranceStatus(RS_NEUTRAL)

			CreateNewDummyObject( "brick_debris1", "CamTochka", -1, -1, CVector(2181.949, 250.742, 5855.640), Quaternion(0, 0, 0, 0), 1)

			local CToch = GetEntityByName("CamTochka")
			local CTochID = CToch:GetId()
			local Cont = GetEntityByName("boss02cont")
			local ContID = Cont:GetId()
			
			Fly("BOSSDIE_cam03", CINEMATIC_NO_AIM, 0, 21, 1, 1 )
			StartCinematic()

			TActivate("RolikEnd_BOSSDIE")
			TActivate("BOSSDIE_RolikFade")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BOSSDIE_RolikFade" active="0">
	<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			TActivate("ContainerEffectsCreate")

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetThrottle(0)
				vehPlayer:SetCustomLinearVelocity(0)
				vehPlayer:setGodMode(1)
			end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ContainerEffectsCreate" active="0">
		<event	timeout="0.1"		eventid="GE_TIME_PERIOD" />
		<script>
			if GetEntityByName("ParisBoss"):IsAlive()==nil then
				local Cont = GetEntityByName("boss02cont")
				if Cont then
					local ContPos = Cont:GetPosition()
					Cont:Remove()
					CreateNewObject {prototypeName = "superBlastWave", objName = "ParisBossBlastWave"}
					local BW = GetEntityByName("ParisBossBlastWave")
					if BW then BW:SetPosition(ContPos) end
					CreateEffectTTLed("ET_PS_BRIDGE_EXP_MAIN", ContPos.x+5, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 600000)
					CreateEffectTTLed("ET_PS_BRIDGE_EXP_MAIN", ContPos.x-5, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 600000)
					CreateEffectTTLed("ET_PS_BRIDGE_EXP_MAIN", ContPos.z+5, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 600000)
					CreateEffectTTLed("ET_PS_BRIDGE_EXP_MAIN", ContPos.z-5, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 600000)
					CreateEffectInsertedInRemove( "ET_PS_VEH_PART_BLOW_BIG_CAB", ContPos.z+5, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), true )
					CreateEffectInsertedInRemove( "ET_PS_VEH_PART_BLOW_BIG_CARGO", ContPos.z-5, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), true )
					CreateEffectInsertedInRemove( "ET_PS_VEH_EXP1_MED1", ContPos, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), true )
					TActivate("ContainerEffectsCreate2")
				end
				trigger:Deactivate()
			end

		</script>
	</trigger>

	<trigger Name="ContainerEffectsCreate2" active="0">
		<event	timeout="0.25"		eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE01", -1, -1, CVector(2090.828, 233.744, 5914.090), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE02", -1, -1, CVector(2092.660, 233.435, 5906.795), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE03", -1, -1, CVector(2096.350, 238.067, 5938.659), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_BOSSDIE" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			SetTolerance( 1042, 1002, RS_ENEMY )
			SetTolerance( 1042, 1005, RS_ENEMY )

			local CToch = GetEntityByName("CamTochka")
			if CToch then CToch:Remove() end

			TDeactivate("RolikBegin_BOSSDIE")
			TDeactivate("ContainerEffectsCreate")
			TDeactivate("ContainerEffectsCreate2")
			TDeactivate("BOSSDIE_RolikFade")

			TActivate("RemoveFireNodes")

			StopPlayingCustomMusic()

			DisableGodMode()
			
			TakeQuest("Disk2OrakulLisa")

			SetCameraBehindPlayerVehicle()

			AllowSave(true)

			trigger:Deactivate()
		</script>
	</trigger>

<!-- ролик с появлением тарелки -->
	<trigger Name="RolikBegin_UFO" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			PlayCustomMusic("Techno04")

			SetWeather(0)

			if QuestStatus("r2m1_TW_AlienInShip")==Q_TAKEN then
				
				getObj("AliensShip"):SetPosition( CVector(1366.725, 0.804, 1801.638))

				Fly("UFO_cam01", CINEMATIC_NO_AIM, 0, 4, 0, 0 )
				Fly("UFO_cam022", CINEMATIC_NO_AIM, 0, 9, 0, 0 )
				Fly("UFO_cam03", CINEMATIC_NO_AIM, 0, 10, 0, 1 )
				StartCinematic()

				TActivate("trLightRemove")
				TActivate("trLightOff")
				TActivate("trUFO_cam03")

			elseif QuestStatus("r2m1_DestroyAlienShip")==Q_TAKEN then

				Fly("UFO_cam03", CINEMATIC_NO_AIM, 0, 10, 0, 1 )
				StartCinematic()
			end

			TActivate("RolikEnd_UFO")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFO_cam03" active="0">
		<event flypath="UFO_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>

			TActivate("trGeneric")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_UFO" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			if QuestStatus("r2m1_TW_AlienInShip")==Q_TAKEN then
				getObj("AliensShip"):SetPosition( CVector(1366.725, 490.804, 1801.638))

				RuleConsole("g_postEffect cinematicEnd")

				TDeactivate("trUFO_cam03")
				TDeactivate("trGeneric")
				TActivate("trLightRemove")

				PlayCustomMusic("Techno01")

				CreateNewDummyObject( "boss04dronegun", "Droid", -1, -1, CVector(1282.018, 0.600, 1646.997), Quaternion(0.049, 0.950, -0.189, -0.244), 0)
				CreateNewDummyObject( "boss04drone", "Droid0", -1, -1, CVector(1282.018, 0.600, 1646.997), Quaternion(0.049, 0.950, -0.189, -0.244), 0)
				CreateNewDummyObject( "dweller_player", "humPlayer", -1, -1, CVector(1228.499, 0.600, 1502.986), Quaternion(-0.065, 0.205, -0.028, 0.976), 0)

				local CToch = GetEntityByName("Droid")
				local CTochID = CToch:GetId()
				local vehPID = GetPlayerVehicleId()
				local humPlID = GetEntityByName("humPlayer"):GetId()

				RuleConsole("cinematic_spring_coeff 1.7")

				Fly(		"UFODIOLOG_cam01", CINEMATIC_NO_AIM, 0, 5, 0, 0 )
				FlyLinked(	"BattleUFO_cam01", CTochID , 5, 0, 0, humPlID )
				Fly(		"UFODIOLOG_cam02", CINEMATIC_NO_AIM, 0, 7, 0, 0 )
				FlyLinked(	"UFODIOLOG_cam03", CTochID , 14, 0, 0, humPlID )
				Fly(		"UFODIOLOG_cam04", CINEMATIC_NO_AIM, 0, 9, 0, 0 )
				FlyLinked(	"UFODIOLOG_cam05", CTochID , 41, 0, 0, humPlID )
				Fly(		"UFODIOLOG_cam06", CINEMATIC_NO_AIM, 0, 10, 0, 0 )
				Fly(		"UFODIOLOG_cam07", CINEMATIC_NO_AIM, 0, 52, 0, 0 )
				Fly(		"UFODIOLOG_cam08", CINEMATIC_NO_AIM, 0, 10, 0, 0 )
				FlyLinked(	"UFODIOLOG_cam09", CTochID , 23, 0, 0, humPlID )
				Fly(		"UFODIOLOG_cam10", CINEMATIC_NO_AIM, 0, 19, 0, 1 )
				StartCinematic()

				TActivate("trUFODIOLOG_cam01")
				TActivate("trUFODIOLOG_cam02")
				TActivate("trUFODIOLOG_cam03")
				TActivate("trUFODIOLOG_cam04")
				TActivate("trUFODIOLOG_cam05")
				TActivate("trUFODIOLOG_cam06")
				TActivate("trUFODIOLOG_cam07")
				TActivate("trUFODIOLOG_cam08")
				TActivate("trUFODIOLOG_cam09")
				TActivate("trUFODIOLOG_cam10")
				TActivate("RolikEnd_UFODIOLOG")
			
			elseif QuestStatus("r2m1_DestroyAlienShip")==Q_TAKEN then

				PlayCustomMusic("IntenseDialogue05")

				CreateNewDummyObject( "boss04dronegun", "Droid", -1, -1, CVector(1282.018, 523.862, 1646.997), Quaternion(-0.043, -0.927, -0.115, 0.356), 0)
				CreateNewDummyObject( "boss04drone", "Droid0", -1, -1, CVector(1282.018, 523.862, 1646.997), Quaternion(-0.043, -0.927, -0.115, 0.356), 0)

				local moverId = CreateNewObject { prototypeName	= "cinematicMover", objName  = "" }
				local moverId1 = CreateNewObject { prototypeName	= "cinematicMover", objName  = "" }
				local mover = GetEntityByID( moverId ) 
				local mover1 = GetEntityByID( moverId1 )
				local controlledObj = GetEntityByName("Droid")
				local controlledObj0 = GetEntityByName("Droid0")

				if controlledObj then
					mover:SetObjAndPath( controlledObj:GetId(), "DroidMove", 120 )
				end

				if controlledObj0 then
					mover1:SetObjAndPath( controlledObj0:GetId(), "DroidMove", 120 )
				end

				local CToch = GetEntityByName("Droid")
				local CTochID = CToch:GetId()
				local vehPID = GetPlayerVehicleId()

				Fly(		"UFODIOLOG_cam01", CINEMATIC_AIM_TO_ID, controlledObj:GetId(), 5, 0, 0 )
				FlyLinked(	"BattleUFO_cam01", CTochID, 5, 0, 0, vehPID )
				Fly(		"BattleUFO_cam04", CINEMATIC_AIM_TO_ID, GetPlayerVehicleId(), 6, 0, 1 )
				StartCinematic()

				TActivate("trBattleUFO_cam01")
				TActivate("trBattleUFO_cam04")
				TActivate("RolikEnd_BattleUFO")
			end

			trigger:Deactivate()
		</script>
	</trigger>

<!-- Диалог игрока с пришельцами -->
	<trigger Name="trUFODIOLOG_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			local humPl = GetEntityByName("humPlayer")
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(1233.521, 436.133, 1493.485))
				vehPlayer:SetRotation(Quaternion(-0.092, -0.183, 0.011, 0.979))
			end

			if humPl then humPl:SetPosition( CVector(1228.499, 435.600, 1502.986)) end

			local moverId = CreateNewObject { prototypeName	= "cinematicMover", objName  = "" }
			local moverId1 = CreateNewObject { prototypeName = "cinematicMover", objName  = "" }
			local mover = GetEntityByID( moverId ) 
			local mover1 = GetEntityByID( moverId1 )
			local controlledObj = GetEntityByName("Droid")
			local controlledObj1 = GetEntityByName("Droid0")
			if controlledObj then
				controlledObj:SetPosition(CVector(1282.018, 523.862, 1646.997))
				mover:SetObjAndPath( controlledObj:GetId(), "DroidMove", 200 )
			end
			if controlledObj1 then
				controlledObj1:SetPosition(CVector(1282.018, 523.862, 1646.997))
				mover1:SetObjAndPath( controlledObj1:GetId(), "DroidMove", 200 )
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam02" active="0">
		<event flypath="UFODIOLOG_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 100, 1 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam03" active="0">
		<event flypath="UFODIOLOG_cam03" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect cinematic01")
			AddCinematicMessage( 101, 0.5 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam04" active="0">
		<event flypath="UFODIOLOG_cam04" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect cinematicEnd")
			AddCinematicMessage( 102, 0.5 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam05" active="0">
		<event flypath="UFODIOLOG_cam05" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect cinematic01")
			AddCinematicMessage( 103, 0.5 )
			AddCinematicMessage( 104, 0.5 )
			AddCinematicMessage( 105, 0.5 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam06" active="0">
		<event flypath="UFODIOLOG_cam06" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect cinematicEnd")
			AddCinematicMessage( 106, 0.5 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam07" active="0">
		<event flypath="UFODIOLOG_cam07" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 107, 0.5 )
			AddCinematicMessage( 108, 0.5 )
			AddCinematicMessage( 109, 0.5 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam08" active="0">
		<event flypath="UFODIOLOG_cam08" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 110, 0.5 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam09" active="0">
		<event flypath="UFODIOLOG_cam09" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect cinematic01")
			AddCinematicMessage( 111, 0.5 )
			AddCinematicMessage( 1111, 0.1 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIOLOG_cam10" active="0">
		<event flypath="UFODIOLOG_cam10" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			RuleConsole("g_postEffect cinematicEnd")
			AddCinematicMessage( 112, 0.5 )
			AddCinematicMessage( 113, 0.5 )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_UFODIOLOG" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			local humPlayer = GetEntityByName("humPlayer")
			if humPlayer then
				humPlayer:Remove()
			end

			local Droid = GetEntityByName("Droid")
			if Droid then
				Droid:Remove()
			end
			local Droid0 = GetEntityByName("Droid0")
			if Droid0 then
				Droid0:Remove()
			end

			TDeactivate("trUFODIOLOG_cam01")
			TDeactivate("trUFODIOLOG_cam02")
			TDeactivate("trUFODIOLOG_cam03")
			TDeactivate("trUFODIOLOG_cam04")
			TDeactivate("trUFODIOLOG_cam05")
			TDeactivate("trUFODIOLOG_cam06")
			TDeactivate("trUFODIOLOG_cam07")
			TDeactivate("trUFODIOLOG_cam08")
			TDeactivate("trUFODIOLOG_cam09")
			TDeactivate("trUFODIOLOG_cam10")
			TActivate("trLightOn")

			RuleConsole("cinematic_spring_coeff 0.7")
			RuleConsole("g_postEffect cinematicEnd")

			CompleteQuest( "r2m1_TW_AlienInShip" )

			AddHistory( "r2_Before_Fight_Oracle" )
			AddFadingMsgId( "fm_history_got" )

			AddQuestItem("quest_blokirator")
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_blokirator")

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(6070.286, 278.812, 4338.888))
				vehPlayer:SetRotation(Quaternion(-0.000, 0.945, 0.001, 0.328))
			end

			StopPlayingCustomMusic()

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>

<!-- диалог перед боем с нло -->
	<trigger Name="trBattleUFO_cam01" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(1216.832, 437.108, 1496.975))
				vehPlayer:SetRotation(Quaternion(-0.082, 0.307, -0.035, 0.948))
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trBattleUFO_cam04" active="0">
		<event flypath="BattleUFO_cam04" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomLinearVelocity( 10 )
				vehPlayer:SetThrottle( 1 )
				vehPlayer:SetExternalPathByName("player_path04")
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_BattleUFO" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetExternalPathByName("player_path04")
				vehPlayer:PlaceToEndOfPath("player_path04")
			end

			local Droid = GetEntityByName("Droid")
			local Droid0 = GetEntityByName("Droid0")
			if Droid then
				Droid:Remove()
			end
			if Droid0 then
				Droid0:Remove()
			end
			TDeactivate("trBattleUFO_cam01")
			TDeactivate("trBattleUFO_cam04")

			CreateNewDummyObject( "r2_crag_copped_3", "cragTR", -1, -1, CVector(1255, 420, 1591), Quaternion(0.0000, 0.1951, 0.0000, 0.9808), 0)

			TActivate("TRIGGER_ALIENSDIE")

			getObj("AliensShip"):NextState()

			SetCameraBehindPlayerVehicle()

			PlayCustomMusic("Battle01")

			local bossp = GetEntityByName("AliensShip")
			if bossp then
				ShowBossIndicator(bossp:GetId())
			end

			SpawnMessageBox("8806")

			trigger:Deactivate()
		</script>
	</trigger>

<!-- смерть НЛО -->
	<trigger Name="RolikBegin_UFODIE" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			PlayCustomMusic("Passage04")

			SaveAllToleranceStatus(RS_NEUTRAL)

			local ufo = GetEntityByName("AliensShip")
			local ufopos = ufo:GetPosition()
			local ufoID = ufo:GetId()
			
			Fly("UFODIE_cam01", CINEMATIC_NO_AIM, 0, 8, 1, 0)
			Fly("UFODIE_cam02", CINEMATIC_AIM_TO_ID, ufoID, 5, 0, 0 )
			Fly("UFODIE_cam032", CINEMATIC_NO_AIM, 0, 6, 0, 0 )
			Fly("UFODIE_cam031", CINEMATIC_NO_AIM, 0, 6, 0, 0 )

			if BookExists("r1_book_doklad") then
				local pcar = CreateVehicleEx("FelixVehicle2", "ProfessorCar", CVector(2693.961, 285.541, 1732.479), 1009, Quaternion(0.000, 0.522, 0.000, 0.853))
				local pcarId = pcar:GetId()

				RuleConsole("cinematic_spring_coeff 6.0")

				Fly("UFODIE_cam04", CINEMATIC_NO_AIM, 0, 16, 0, 0 )
				FlyLinked("AfterBattle", pcarId, 11, 0, 1, GetPlayerVehicleId())
				StartCinematic()

				TActivate("trAfterBattle")
			else
				Fly("UFODIE_cam04", CINEMATIC_NO_AIM, 0, 16, 0, 1 )
				StartCinematic()
			end

			CreateEffectTTLed("ET_S_UFODEATH", CVector(ufopos), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 30000)

			TActivate("RolikEnd_UFODIE")
			TActivate("trUFODIE_EF")
			TActivate("trUFODIE_cam02")
			TActivate("trUFODIE_cam04")
			TActivate("trUFODIE_FADE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIE_FADE" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local moverId = CreateNewObject { prototypeName	= "cinematicMover", objName  = "ufoMover" }
			local mover = GetEntityByID( moverId ) 
			local controlledObj = GetEntityByName("AliensShip")
			if controlledObj then
				controlledObj:SetRotation(Quaternion(0.004, -0.683, -0.009, 0.730))
				mover:SetObjAndPath( controlledObj:GetId(), "bossMove1", 30 )
			end
			
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomControlEnabled( true )
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetCustomControlEnabled( false )
				vehPlayer:SetGamePositionOnGround( CVector(2795.072, 284.827, 1836.845))
				vehPlayer:SetRotation(Quaternion(0.000, -0.952, -0.000, 0.306))
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIE_EF" active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			local ufo = GetEntityByName("AliensShip")
			local ufoPos = ufo:GetPosition()

			if (ufoPos.x > 1721) and (1729 > ufoPos.x) and (ufoPos.z > 1726 ) and (1734 > ufoPos.z ) then
				CreateNewSgNodeObject("ET_PS_ROCKS1", "boom01", -1, -1, CVector(1697.341, 463.358, 1706.809), Quaternion(0.078, 0.855, 0.496, 0.134))
				CreateNewSgNodeObject("ET_PS_DRONE_EX", "boom011", -1, -1, CVector(1697.341, 463.358, 1706.809), Quaternion(0.078, 0.855, 0.496, 0.134))
			end

			if (ufoPos.x > 1810) and (1818 > ufoPos.x) and (ufoPos.z > 1654 ) and ( 1662 > ufoPos.z ) then
				CreateNewSgNodeObject("ET_PS_ROCKS1", "boom02", -1, -1, CVector(1808.321, 412.275, 1578.256), Quaternion(0.078, 0.855, 0.496, 0.134))
				CreateNewSgNodeObject("ET_PS_DRONE_EX", "boom022", -1, -1, CVector(1808.321, 412.275, 1578.256), Quaternion(0.078, 0.855, 0.496, 0.134))
			end

			if (ufoPos.x > 1903) and (1911 > ufoPos.x) and (ufoPos.z > 1594 ) and (1602 > ufoPos.z ) then
				CreateNewSgNodeObject("ET_PS_AIRWAVE", "boom03", -1, -1, CVector(1943.270, 295.807, 1407.104), Quaternion(0.078, 0.855, 0.496, 0.134))
				CreateNewSgNodeObject("ET_PS_BIG_SMOKE12", "boom031", -1, -1, CVector(1943.270, 295.807, 1407.104), Quaternion(0.078, 0.855, 0.496, 0.134))
				CreateNewSgNodeObject("ET_PS_BIG_SMOKE12", "boom032", -1, -1, CVector(1943.270, 295.807, 1407.104), Quaternion(0.078, 0.855, 0.496, 0.134))
				trigger:Deactivate()
			end
		</script>
	</trigger>

	<trigger Name="trUFODIE_cam02" active="0">
		<event flypath="UFODIE_cam02" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			local station = GetEntityByName("AliensShipStation3")
			if station then station:Remove() end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trUFODIE_cam04" active="0">
		<event flypath="UFODIE_cam04" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			AddCinematicMessage( 131, 9 )

			CreateEffectTTLed("ET_S_UFODEATH", CVector(camPos), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 30000)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trAfterBattle" active="0">
		<event flypath="AfterBattle" eventid="GE_START_CINEMATIC_FLY" ObjName="Player1" />
		<script>
			PlayCustomMusic("Bio06")
			
			local pcar = GetEntityByName("ProfessorCar")
			if pcar then
				pcar:SetSkin(1)
				pcar:SetGamePositionOnGround(CVector(2693.961, 285.541, 1732.479))
				pcar:SetRotation(Quaternion(0.000, 0.522, 0.000, 0.853))
				pcar:SetExternalPathByName("AfterBattle_path01")
				pcar:SetCustomLinearVelocity( 13 )
				pcar:SetCruisingSpeed(13)
				pcar:SetMaxSpeed(13)
			end

				trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RolikEnd_UFODIE" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>

			RestoreAllToleranceStatus()
		
			TDeactivate("trUFODIE_FADE")	
			TDeactivate("trUFODIE_EF")
			TDeactivate("trUFODIE_cam02")
			TDeactivate("trUFODIE_cam04")
			TDeactivate("trAfterBattle")
			
			TActivate("VyborFinala")
			TActivate("trUFODIE_PlaceUfo")

			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetGamePositionOnGround( CVector(2795.072, 284.827, 1836.845))
				vehPlayer:SetRotation(Quaternion(0.000, -0.952, -0.000, 0.306))
			end

			local mover = GetEntityByName("ufoMover")
			if mover then mover:Remove() end

			StopPlayingCustomMusic()

			SetCameraBehindPlayerVehicle()
			
			if BookExists( "r1_book_doklad" ) then
				local pcar = GetEntityByName("ProfessorCar")
				if pcar then
					pcar:PlaceToEndOfPath("AfterBattle_path01")
					pcar:SetGamePositionOnGround( CVector(2772.473, 286.377, 1791.452))
		   			pcar:SetRotation(Quaternion(-0.000, 0.216, 0.000, 0.976))
					pcar:setGodMode(1)
					pcar:setImmortalMode(1)
					pcar:SetExternalPathByName("AfterBattle_path02")
				end

				RuleConsole("cinematic_spring_coeff 0.7")
			
				StartConversation("ProfessorMal")
			else
				TActivate("ToR2M1AfterBoss")
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Ставим НЛО на последнюю позицию отдельно, так как не работает в триггере завершения -->
	<trigger Name="trUFODIE_PlaceUfo" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>
			local ufo = GetEntityByName("AliensShip")
			if ufo then
				ufo:SetPosition(CVector(1900.168, 280.978, 1610.655))
				ufo:SetRotation(Quaternion(0.179, 0.810, -0.266, -0.491))
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Расстреляли Жулика -->
	<trigger Name="Trigger_Antipod_Die" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="GulikCar" />
		<script>

			CompleteQuest( "r2m1_ArtGulik_Quest" )
		
			SaveAllToleranceStatus(RS_NEUTRAL)
			
			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 5
			PlfCoor.z = PlfCoor.z + 15

			Plf:SetCustomLinearVelocity(0)
			Plf:SetThrottle(0)

			FlyAround(0.5, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
			StartCinematic()
			
			AddCinematicMessage( 70, 1 )
		
			TActivate("Trigger_Antipod_Die_End")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Trigger_Antipod_Die_End" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
		
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			AddQuestItem("quest_art_masterpice")
			
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_art_masterpice")

			trigger:Deactivate()
		</script>
	</trigger>
</triggers>