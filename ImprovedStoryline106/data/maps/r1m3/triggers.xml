<?xml version="1.0" encoding="windows-1251" standalone="yes" ?>
<triggers>

	<trigger	Name="GlobalVar"	active="1">
		<event	timeout="0.1"		eventid="GE_TIME_PERIOD" />
		<script>
			SetVar("globalEnterToPesht",1)
			SetVar("ZasadaAR",0)
			SetVar("DeadMer",0)
			SetVar("QuickWay",0)
			SetVar("QuickWayAlt",0)
			SetVar("KnownMap",0)
			SetVar("BeglecPrice",0)
			trigger:Deactivate()
		</script>
	</trigger>



	<trigger	Name="trVaterlandPlaceSecret"	active="1">
		<event	timeout="0.1"			eventid="GE_TIME_PERIOD" />
		<script>
			local gunlist = {"specter01","storm01","pkt01","hornet01","vector01","vulcan01","hurricane01"}
			local len = getn(gunlist)

			for i=1,12 do
				--println("step"..i.."succesful")
				CreateBoxWithAffixGun(CVector(getPos("SecretPlace"..i.."_loc")), gunlist[exrandom(len)], random(0, 2))
			end
			trigger:Deactivate()
		</script>
	</trigger>


	<trigger	Name="trAutoSave"	active="0">
		<event eventid="GE_GAME_START" ObjName="Player1" />
		<script>
		</script>
	</trigger>





	<trigger	Name="trStartMap"	active="1">
		<event eventid="GE_GAME_START" ObjName="Player1" />
		<script>
			
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE01", -1, -1, CVector(4214.315, 231.049, 1020.738), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE02", -1, -1, CVector(4136.448, 252.076, 834.866), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE03", -1, -1, CVector(4183.487, 235.000, 1217.818), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE04", -1, -1, CVector(4043.283, 235.428, 723.935), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE05", -1, -1, CVector(4045.008, 234.819, 1037.936), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))
			CreateNewSgNodeObject("ET_PS_HOUSE_MED_FIRE", "FIRE06", -1, -1, CVector(4221.199, 231.304, 1010.331), Quaternion(0.0000, 0.0000, 0.0000, 1.0000))

			TActivate("tr_Start0")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger	Name="trStartMap221"	active="1">
		<event eventid="GE_GAME_START" ObjName="Player1" />
		<script>
			if IsQuestTaken("d_chehol1") then

				TActivate("Chehol_1")
				
				if QuestStatus("FreeExtremistLeader_Quest1")==Q_COMPLETED then
					TDeactivate("triggerExitToMap14")
				end

				trigger:Deactivate()
			end
		</script>
	</trigger>


	<trigger Name="tr_Start0" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			if IsQuestTaken("d_FindRealFatherRoom_Quest") then
				local tp = GetEntityByName("Pesht")
				if tp then
					tp:SetOpenGateToPlayer( false )
				end
			end

			SetConditionalClosingForTown( "Pesht", "r1m3", true )

			CreateNewDummyObject( "arena_barricade8", "zagr1", -1, -1, CVector(5523.000, 217, 1423.368), Quaternion(0.000, -0.706, 0.000, 0.709), 0)
			CreateNewDummyObject( "arena_barricade8", "zagr2", -1, -1, CVector(5631.000, 217, 1422.771), Quaternion(0.000, -0.706, 0.000, 0.709), 0)

			CreateNewDummyObject( "bridge_military", "BridgeForDestroy", -1, -1, CVector(5576.837, 202.7, 1423.237), Quaternion(0.0000, 0.7086, 0.0000, 0.7056), 0)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_OpenTownAndShowButtonInPesht" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			local tp = GetEntityByName("Pesht")
			if tp then
				tp:SetOpenGateToPlayer( true )
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_PeshtTrue" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locPeshtTrue" />
		<event eventid="GE_OBJECT_IN_LOCATION" ObjName="locPeshtTrue" />
		<script>
			SetVar("globalEnterToPesht",1)
		</script>
	</trigger>

	<trigger Name="tr_PeshtFalse" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locPeshtFalse" />
		<event eventid="GE_OBJECT_IN_LOCATION" ObjName="locPeshtFalse" />
		<script>
			SetVar("globalEnterToPesht",-1)
		</script>
	</trigger>

	<trigger Name="tr_LeavePesht" active="1">
		<event eventid="GE_TOWN_CONDITIONAL_CLOSING" ObjName="Pesht" />
		<script>
			if IsQuestComplete("d_DestroyBridge_Quest") or IsQuestComplete("FightForPesht") then
				local b = SpawnMessageBox( "8804" )
				if b == 1 then
					local a = (-1)*(GetVar("globalEnterToPesht").AsInt)
					SetVar("globalEnterToPesht",a)

					TActivate ("tr_RolikAndPosLeavePesht")
				else
					TActivate ("tr_RolikAndPosLeavePesht")
				end
			else
				local b = SpawnMessageBox( "8805" )
				if b == 1 then
					if GetPlayerMoney() >= 1500 then
						AddPlayerMoney( -1500 )

						local a = (-1)*(GetVar("globalEnterToPesht").AsInt)
						SetVar("globalEnterToPesht",a)

						TActivate ("tr_RolikAndPosLeavePesht")
					else
						SpawnMessageBox( "6006" )	

						TActivate ("tr_RolikAndPosLeavePesht")			
					end
				else
					TActivate ("tr_RolikAndPosLeavePesht")
				end
			end
		</script>
	</trigger>

	<trigger Name="tr_RolikAndPosLeavePesht" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			LeaveTown()

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 75
			PlfCoor.z = PlfCoor.z + 15

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround(6, 0, 10, 5, PlfCoor, PlfID, 0, 1)
			StartCinematic()

			local a = GetVar("globalEnterToPesht").AsInt
			if a == 1 then
				Plf:SetCustomControlEnabled( true ) 
				Plf:SetGamePositionOnGround( CVector(3912.081, 245, 3718.224))
				Plf:SetRotation(Quaternion(-0.059, -0.707, -0.033, 0.704))
				Plf:SetExternalPathByName("pesht_true")
				Plf:SetCustomControlEnabled( false )  

				TActivate( "tr_RolikAndPosLeavePesht_true" )    
			else
				Plf:SetCustomControlEnabled( true ) 
				Plf:SetGamePositionOnGround( CVector(4224.247, 245, 3705.479))
				Plf:SetRotation(Quaternion(0.039, 0.778, -0.046, 0.626))
				Plf:SetExternalPathByName("pesht_false")
				Plf:SetCustomControlEnabled( false ) 

				TActivate( "tr_RolikAndPosLeavePesht_false" )     
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_RolikAndPosLeavePesht_true" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetRotation(Quaternion(-0.059, -0.707, -0.033, 0.704))
			Plf:PlaceToEndOfPath("pesht_true")
			Plf:SetCustomControlEnabled( false )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="tr_RolikAndPosLeavePesht_false" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetRotation(Quaternion(0.039, 0.778, -0.046, 0.626))
			Plf:PlaceToEndOfPath("pesht_false")
			Plf:SetCustomControlEnabled( false )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>




	<trigger Name="SHAHTSBANDIT" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("ShahtsBoss",1002,CVector(2202, 285, 6936),{"r1m1_molokovoz02","r1m3_Fighter01","r1m1_CaravanBug02"}, CVector(2041, 287, 7182), 1)

			TakeQuest("d_BombShahtsAtakBandits_Quest")

			TActivate("SHAHTSBANDITBOSSDIE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="SHAHTSBANDITBOSSDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="ShahtsBoss" />
		<script>
   			CompleteQuest( "d_BombShahtsAtakBandits_Quest" )

			trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="preBOOOM" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OhranaBridge" />
		<script>
   			TActivate( "BOOOM" )

			CompleteQuest("d_DestroyBridge_Quest1")

			trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="BOOOM" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheDestroyBridgeLoc" />
		<script>
  			if IsQuestTaken("d_DestroyBridge_Quest2") then
				RemoveQuestItem("quest_explosive")

   				CompleteQuest( "d_DestroyBridge_Quest2" )
   
				AddFadingMsg("Вы воспользовались предметом: Взрывчатка")

				local a = GetEntityByName("BaseGuardian_enter")
				if a then a:SetProperty("Active",0) end

				TActivate( "RolikBegin_BOOOM" )

				trigger:Deactivate()
  			end
		</script>
	</trigger>

	<trigger Name="BASEATTACK" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD"/>
		<script>
			local rrr = GetEntityByName ("zagr1")
			if rrr then rrr:Remove() end
			local rrr = GetEntityByName ("zagr2")
			if rrr then rrr:Remove() end

			local a = GetEntityByName("BaseGuardian_enter")
			if a then a:SetProperty("Active",0) end

			TActivate( "BASEATTACKEND" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BASEATTACKEND" active="0">
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="BaseGuardianLoc_out" />
		<script>
			CreateNewDummyObject( "arena_barricade8", "zagr1", -1, -1, CVector(5523.000, 217, 1423.368), Quaternion(0.0000, -0.7056, 0.0000, 0.7086), 0)
			CreateNewDummyObject( "arena_barricade8", "zagr2", -1, -1, CVector(5631.000, 217, 1422.771), Quaternion(0.0000, -0.7056, 0.0000, 0.7086), 0)

			local a = GetEntityByName("BaseGuardian_enter")
			if a then a:SetProperty("Active",1) end

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="FATHERHOUSE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="HouseLoc" />
		<script>
 			if  IsQuestTaken("d_FatherRoomInMinin_Quest") and not(IsQuestComplete("d_FatherRoomInMinin_Quest")) then
				TActivate( "RolikBegin_FATHERHOUSE" )

   				CompleteQuest( "d_FatherRoomInMinin_Quest" )

				AddHistory( "r1_Father_Room_00" )
				AddFadingMsgId( "fm_history_got" )
				AddQuestItem("quest_key_for_submarine")
				AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_key_for_submarine")
			end
			
			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomControlEnabled( true )
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetCustomControlEnabled( false )
			end
			
			if  IsQuestTaken("r3m2_RideToFatherRoomAfterOracul") and not(IsQuestComplete("r3m2_RideToFatherRoomAfterOracul")) then
				TActivate( "RolikBegin_FATHERHOUSERETURN" )

   				CompleteQuest( "r3m2_RideToFatherRoomAfterOracul" )
			end
		</script>
	</trigger>





<!-- Освободить скважину -->
	<trigger Name="ATTACKOILMINE" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("OilMineBoss",1002,CVector(6969,257,7068),{"Sml401","r1m3_Fighter01","r1m1_scout02"}, nil, 1)

			TakeQuest("d_DriveBanditFromOilMine_Quest")

			TActivate("BOSSOILMINEDIE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BOSSOILMINEDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OilMineBoss" />
		<script>

			CompleteQuest( "d_DriveBanditFromOilMine_Quest" )

			SetTolerance( 1100, 1047, RS_NEUTRAL )

			CreateVehicleEx("DemoBandit", "vehicleRunner", CVector(7006.653, 258.253, 7163.328), 1044)
			CreateNewDummyObject( "brick_debris1", "CamTochka", -1, -1, CVector(6931.543, 280.175, 7110.825), Quaternion(0, 0, 0, 0), 1)

			local CToch = GetEntityByName("CamTochka")
			local CTochID = CToch:GetId()
			local camCar = GetEntityByName("vehicleRunner")
			local camCarID = camCar:GetId()

			SaveAllToleranceStatus(RS_NEUTRAL)

--			Fly( "NeftVyshCam", CINEMATIC_NO_AIM, 0, 13, 1, 1)
			FlyLinked( "SPYMER_cam01", CTochID, 13, 1, 1, camCarID )
			StartCinematic() 

			AddCinematicMessage( 20, 1 )

			TActivate( "BOSSOILMINENDCINIMATIC" )
			TActivate("BOSSOILMINEDIEFADE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BOSSOILMINEDIEFADE" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			local vehP = GetPlayerVehicle()
			if vehP then
				vehP:SetCustomControlEnabled( true )
				vehP:SetCustomLinearVelocity( 0 )
				vehP:SetThrottle( 0 )
				vehP:SetCustomControlEnabled( false )
				vehP:SetGamePositionOnGround(CVector(7010.846, 257.805, 7117.275))
				vehP:SetRotation(Quaternion(0.001, 0.922, 0.000, -0.388))
			end
			
			for i = 0,2 do
				if GetEntityByName("OilMineBoss_vehicle_"..i) then
					GetEntityByName("OilMineBoss_vehicle_"..i):Remove()
					-- println("Removed vehicle "..i)
				end
			end

			
			local vehR = GetEntityByName("vehicleRunner")
			if vehR then
				vehR:SetGamePositionOnGround(CVector(6954.294, 259.027, 7065.042))
				vehR:SetRotation(Quaternion(0.008, 0.931, 0.020, -0.364))
				vehR:SetSkin(4)
				vehR:SetExternalPathByName("banditoilmine_path")
				vehR:SetCruisingSpeed(7)
			end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="BOSSOILMINENDCINIMATIC" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			local vehR = GetEntityByName("vehicleRunner")
			if vehR then vehR:Remove() end

			local CToch = GetEntityByName("camTochka")
			if CToch then CToch:Remove() end

			TeamCreate("OilMineRuner",1044,CVector(6897.545, 261.550, 7004.525),{"DemoBandit"}, nil, 1, Quaternion(-0.002, 0.930, 0.007, -0.367))
			local vehP = GetEntityByName("OilMineRuner_vehicle_0")
			if vehP then
				vehP:SetExternalPathByName("banditoilmine_path")
				vehP:SetSkin(4)
				vehP:SetCruisingSpeed(30)
			end

			TakeQuest("d_FindBanditBaseOfOilMine_Quest")

			TActivate("RUNTORUNER")
			TActivate("RUNTORUNERENDRACE")

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>




<!-- Догнать бандита -->
	<trigger Name="RUNTORUNER" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			local run = GetEntityByName("OilMineRuner_vehicle_0")
			local pl = GetPlayerVehicle()
			local len

			if run and run:IsAlive() then
				len = Dist(pl, run)

				if (len > 305) or (15 > len) then
					SaveAllToleranceStatus(RS_NEUTRAL)

					local Plf = GetPlayerVehicle()
					local PlfID = GetPlayerVehicleId()
					local PlfCoor = Plf:GetPosition()
					PlfCoor.y = PlfCoor.y + 25*0.74
					PlfCoor.z = PlfCoor.z + 25*0.74

					Plf:SetCustomControlEnabled( true )
					Plf:SetCustomLinearVelocity( 0 )
					Plf:SetThrottle( 0 )
					Plf:SetCustomControlEnabled( false )

					FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
					StartCinematic()

					AddCinematicMessage( 18, 1 )

					TActivate("RUNTORUNER_cp")

					TDeactivate("RUNTORUNERENDRACE")

					trigger:Deactivate()
				end
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				local Plf = GetPlayerVehicle()
				local PlfID = GetPlayerVehicleId()
				local PlfCoor = Plf:GetPosition()
				PlfCoor.y = PlfCoor.y + 25*0.74
				PlfCoor.z = PlfCoor.z + 25*0.74

				Plf:SetCustomControlEnabled( true )
				Plf:SetCustomLinearVelocity( 0 )
				Plf:SetThrottle( 0 )
				Plf:SetCustomControlEnabled( false )

				FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
				StartCinematic()

				AddCinematicMessage( 38, 1 )

				TActivate("RUNTORUNER_cp")

				TDeactivate("RUNTORUNERENDRACE")

				trigger:Deactivate()
			end
		</script>
	</trigger>
	<trigger Name="RUNTORUNER_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			local r = GetEntityByName ("OilMineRuner")
			if r then r:Remove() end

			FailQuestIfTaken("d_FindBanditBaseOfOilMine_Quest")

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="RUNTORUNERENDRACE" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="EndRaceLoc" />
		<script>
			TeamCreate("OilMineBaseBoss",1002,CVector(4483, 265, 7496),{"r1m3_Fighter01","r1m3_Fighter02", "DemoBandit"},CVector(4546, 263, 7479), 1)

			local runner = GetEntityByName("OilMineRuner_vehicle_0")
			local runner_new = GetEntityByName("OilMineBaseBoss"):GetVehicle(2)

			CompleteQuest( "d_FindBanditBaseOfOilMine_Quest1" )

			if runner and runner_new then
				local runner_pos = runner:GetPosition()
				local runner_rot = runner:GetRotation()
				local runner_skin = runner:GetSkin()

				runner:Remove()

				runner_new:SetGamePositionOnGround(runner_pos)
				runner_new:SetRotation(runner_rot)
				runner_new:SetSkin(runner_skin)
			end
			
			SetTolerance( 1100, 1044, RS_ENEMY )

			TActivate("KILLBOSSOILMINEBASE")

			TDeactivate("RUNTORUNER")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="KILLBOSSOILMINEBASE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OilMineBaseBoss" />
		<script>
   			CompleteQuest( "d_FindBanditBaseOfOilMine_Quest2" )
   			
   			TActivate("KILLBOSSOILMINEBASE2")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="KILLBOSSOILMINEBASE2" active="0">
		<event	timeout="1"		eventid="GE_TIME_PERIOD" />
		<script>
		
   			StartConversation( "BanditVyshka" )

			trigger:Deactivate()
		</script>
	</trigger>



<!-- Догнать мера -->
	<trigger Name="SPYMER" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			TActivate( "RolikBegin_SPYMER" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RUNMER" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			local run = GetEntityByName("MerCar_vehicle_0")
			local pl = GetPlayerVehicle()
			local len

			if run and run:IsAlive()  then
				len = Dist(pl, run)
				if (len > 305) or (15 > len) then
					SaveAllToleranceStatus(RS_NEUTRAL)

					local Plf = GetPlayerVehicle()
					local PlfID = GetPlayerVehicleId()
					local PlfCoor = Plf:GetPosition()
					PlfCoor.y = PlfCoor.y + 25*0.74
					PlfCoor.z = PlfCoor.z + 25*0.74

					Plf:SetCustomControlEnabled( true )
					Plf:SetCustomLinearVelocity( 0 )
					Plf:SetThrottle( 0 )
					Plf:SetCustomControlEnabled( false )

					FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
					StartCinematic()

					AddCinematicMessage( 19, 1 )

					TActivate( "RUNMER_cp" )

					TDeactivate("RUNMEREND")

					trigger:Deactivate()
				end
			else
				SetVar("DeadMer",1)
				
				TActivate("Ending35")

				TDeactivate("RUNMEREND")

				trigger:Deactivate()
			end
		</script>
	</trigger>
	<trigger Name="RUNMER_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			local r = GetEntityByName ("MerCar")
			if r then r:Remove() end

			FailQuestIfTaken("d_MoveToMer_Quest")
			FailQuestIfTaken("d_FindWorkersToOilMine_Quest")

			TakeQuest("d_PayWorkersMoney_Quest")

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="RUNMEREND" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheSpy" />
		<script>
			TDeactivate("RUNMER")
			
			CompleteQuestIfTaken("d_MoveToMer_Quest")

			TActivate( "RolikBegin_THESPY" )

			trigger:Deactivate()
		</script>
	</trigger>

<!-- Узнать где туннель -->
	<trigger Name="TUNNELLOCATION" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TunnelLoc" />
		<script>
			CompleteQuestIfTaken("d_FindDoorInTunel_Quest")

			TActivate("RolikBegin_Tunel")

			AddHistory( "r1_See_Tonnel_00" )
			AddFadingMsgId( "fm_history_got" )

			trigger:Deactivate()
		</script>
	</trigger>




<!-- Устроить засаду -->
	<trigger Name="ZASADATUNEL" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ZasadaLocQ" />
		<script>
   			CompleteQuest( "d_FindZasadaInTunel_Quest" )

			TActivate( "RolikBegin_Zasada" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RUNTOPIONEER" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			local run = GetEntityByName("Pioneer_vehicle_0")
			local pl = GetPlayerVehicle()
			local len

			if run and run:IsAlive() then
				len = Dist(pl, run)

				if (15 > len) then
					SetTolerance( 1100, 1046, RS_ENEMY )

					local parentrun = GetEntityByName("Pioneer")
					if parentrun then
						parentrun:SetDestination(pl:GetPosition())
					end

					FailQuest( "d_SerchCarTunel_Quest" )
					FailQuest("d_FindKeyInTunel_Quest")
					TakeQuest("d_KillCarTunel_Quest")

					TDeactivate( "PIONEERASGARD" )

					trigger:Deactivate()

				elseif (len > 305) then
					SaveAllToleranceStatus(RS_NEUTRAL)

					local Plf = GetPlayerVehicle()
					local PlfID = GetPlayerVehicleId()
					local PlfCoor = Plf:GetPosition()
					PlfCoor.y = PlfCoor.y + 25*0.74
					PlfCoor.z = PlfCoor.z + 25*0.74

					Plf:SetCustomControlEnabled( true )
					Plf:SetCustomLinearVelocity( 0 )
					Plf:SetThrottle( 0 )
					Plf:SetCustomControlEnabled( false )

					FlyAround(6, 0, 25, 6, PlfCoor, PlfID, 1, 1)
					StartCinematic()

					AddCinematicMessage( 18, 1 )

					TActivate("PIONEERDEAD_cp")

					TDeactivate( "PIONEERASGARD" )
					TDeactivate("PIONEERDEAD")

					FailQuest("d_SerchCarTunel_Quest")

					trigger:Deactivate()

				elseif 1.499>(GetTolerance(1100, 1046)) then
					FailQuest( "d_SerchCarTunel_Quest" )
					FailQuest("d_FindKeyInTunel_Quest")
					TakeQuest("d_KillCarTunel_Quest")

					TDeactivate( "PIONEERASGARD" )

					trigger:Deactivate()
				end
			end
		</script>
	</trigger>

	<trigger Name="PIONEERDEAD" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="Pioneer" />
		<script>
			TDeactivate( "PIONEERASGARD" )
			TDeactivate( "RUNTOPIONEER" )
			TActivate( "TRIGGER_TUNNELOPEN" )

			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround(6, 0, 25, 8, PlfCoor, PlfID, 3, 1)
			StartCinematic()

			AddCinematicMessage(9, 2)

			TActivate( "PIONEERDEAD_cp" )

			FailQuestIfTaken( "d_SerchCarTunel_Quest" )
			FailQuestIfTaken("d_FindKeyInTunel_Quest")
			CompleteQuestIfTaken("d_KillCarTunel_Quest")
			TakeQuest( "d_OpenTunel_Quest" )
   			

			AddQuestItem("quest_key_for_tunnel")
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_key_for_tunnel")

			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="PIONEERDEAD_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			SetCameraBehindPlayerVehicle()

			local run = GetEntityByName("Pioneer_vehicle_0")
			if run then
				run:Remove()
			end

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="PIONEERASGARD" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="PioneerLoc" />
		<script>
			FailQuest("d_FindKeyInTunel_Quest")
   			CompleteQuest( "d_SerchCarTunel_Quest" )
			
			TDeactivate( "PIONEERDEAD" )
			TDeactivate( "RUNTOPIONEER" )

			TActivate( "RolikBegin_PIONEERASGARD" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="TRIGGER_TUNNELOPEN" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TunnelLoc" />
		<script>
			if  IsQuestTaken("d_OpenTunel_Quest") then
				local b = GetEntityByName("ToR2M1")
				if b then b:SetProperty("Active",1) end
			end
		</script>
	</trigger>



	<trigger Name="TRIGGER_THIEFWAR" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("ThiefCar",1002,CVector(6919.780, 297.239, 1115.137),{"UralShot"}, nil, 0, Quaternion(-0.030, 0.866, -0.000, 0.498))

			TActivate("TRIGGER_THIEFDIE")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="TRIGGER_THIEFDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="ThiefCar" />
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			Plf:SetCustomControlEnabled( true )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetThrottle( 0 )
			Plf:SetCustomControlEnabled( false )

			FlyAround(6, 0, 25, 8, PlfCoor, PlfID, 1, 1)
			StartCinematic()

			AddCinematicMessage(31, 1 )

			TActivate("TRIGGER_THIEFDIE_cp")

   			CompleteQuestIfTaken( "r1m3_FightWithThief" )
   			CompleteQuestIfTaken( "Zachisti2_Quest" )

   			if not(IsQuestComplete( "Zachisti2_Quest" )) then
   				TakeQuest( "r1m3_MoveToOraculAfterThief" )
   				TActivate("TRIGGER_LISAAFTERTHIEF")
   			end
   			
			AddQuestItem("quest_disk_2")
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_disk_2")
			trigger:Deactivate()
		</script>
	</trigger>
	<trigger Name="TRIGGER_THIEFDIE_cp" active="0">
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			
			local ArmyVeh1 = GetEntityByName("ArmiaTSP_vehicle_0")
			local ArmyVeh2 = GetEntityByName("ArmiaTSP_vehicle_1")
			local ArmyVeh3 = GetEntityByName("ArmiaTSP_vehicle_2")
			if ArmyVeh1 then
				ArmyVeh1:Remove()
			end
			if ArmyVeh2 then
				ArmyVeh2:Remove()
			end
			if ArmyVeh3 then
				ArmyVeh3:Remove()
			end

			local vehBrig = GetEntityByName("Brigada1_vehicle_0")
			if vehBrig then vehBrig:Remove() end

			local vehBrig1 = GetEntityByName("Brigada2_vehicle_0")
			if vehBrig1 then vehBrig1:Remove() end

			if IsQuestComplete( "Zachisti2_Quest" ) then
				SetTolerance( 1100, 1012, RS_ALLY )
				getObj("TheBase"):SetBelong(1010)
			end

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate() 
		</script>
	</trigger>





	<trigger Name="TRIGGER_LISAAFTERTHIEF" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="SnatchLoc" />
		<script>
			TActivate( "RolikBegin_LISAAFTERTHIEF" )

   			FailQuest( "r1m3_MoveToOraculAfterThief" )
   			TakeQuest( "LisaVPeshte" )

			RemoveQuestItem("quest_disk_1")
			RemoveQuestItem("quest_disk_2")
			RemoveQuestItem("quest_key_for_submarine")
			
			AddFadingMsgByStrIdFormatted( "fm_player_rem_thing", "quest_disk_1")
			AddFadingMsgByStrIdFormatted( "fm_player_rem_thing", "quest_disk_2")
			AddFadingMsgByStrIdFormatted( "fm_player_rem_thing", "quest_key_for_submarine")

			AddFadingMsgId( "fm_history_got" )

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TRIGGER_ORACLEABOTPLATE" active="1">
		<event eventid="GE_GAME_START" ObjName="Player1" />
		<script>
			if  QuestStatus("r1m3_TW_OralceAboutAlien")==Q_TAKEN then
   				CompleteQuest( "r1m3_TW_OralceAboutAlien" )
   				TakeQuest("r2m1_TW_SellsCivilian")

				TActivate( "RolikBegin_ORACLEABOTPLATE" )

				AddHistory( "r1_Before_Fight_Aliens" )
				AddFadingMsgId( "fm_history_got" )

				trigger:Deactivate()
			end
		</script>
	</trigger>





	<trigger Name="TRIGGER_ORACLEAGRESSOR" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="OraculEndLoc" />
		<script>
			if  IsQuestTaken("r2m1_DeployBloks") and not(IsQuestComplete("r2m1_DeployBloks") or IsQuestFailed("r2m1_DeployBloks")) then
   				TakeQuest( "r1m3_DestroyOracle" )

				TActivate( "RolikBegin_ORACLEAGRESSOR" )

				trigger:Deactivate()
			end
		</script>
	</trigger>

	<trigger Name="TRIGGER_ORACLEAGRESSORDIE" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OracleFlyBoss" /> 
		<script>
			SaveAllToleranceStatus(RS_NEUTRAL)

   			CompleteQuest( "r2m1_DeployBloks1" )
   			CompleteQuest( "r1m3_DestroyOracle" )
   			CompleteQuest( "r4m2_NeutralizePlate" )
--   		TakeQuest("r4m2_BlokiratorToUFO")


			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			Plf:SetCustomLinearVelocity(0)
			Plf:SetThrottle(0)

			FlyAround(6, 0, 25, 10, PlfCoor, PlfID, 1, 1 )
			StartCinematic()

			AddCinematicMessage( 8810, 1)

			TActivate("TRIGGER_ORACLEAGRESSORDIECINEMATIC")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="TRIGGER_ORACLEAGRESSORDIECINEMATIC" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
		
			RestoreAllToleranceStatus()
			
			StopPlayingCustomMusic()
		
			GetEntityByName("qa1"):Remove()
			GetEntityByName("qa2"):Remove()
			GetEntityByName("qa3"):Remove()
			GetEntityByName("qa4"):Remove()
			GetEntityByName("qa5"):Remove()
			
			CompleteQuest("r4m2_DestroyPlate")

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="TriggerBonnyTrap" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("BonnyTeam",1005,CVector(2176,293,6461), {"Ural00"},CVector(2315,295,6407), 1)

			trigger:Deactivate()
		</script>
	</trigger>

		<trigger Name="TriggerLabirintCarCreate2" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("OldTownOutsiderCar2",1002,CVector(1387,259,3947), {"r1m3_molokovozInOldCity"},nil, 1)

			local tv = GetEntityByName("OldTownOutsiderCar2")
			if tv then
				tv:StackOpen()
				tv:SetDestination( CVector(1847,259,4119))
				tv:SetDestination( CVector(1781,259,3925))
				tv:SetDestination( CVector(1989,259,3742))
				tv:SetDestination( CVector(2415,259,4126))
				tv:SetDestination( CVector(1688,259,3769))
				tv:StackLoop()
				tv:StackClose()
			end

			TActivate("TriggerLabirintCarDie2")

			TakeQuest("r1m3_OldTownOutsiderCar2_Quest");

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TriggerLabirintCarDie2" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="OldTownOutsiderCar2" />
		<script>
   			CompleteQuest( "r1m3_OldTownOutsiderCar2_Quest" )
   			
   			if GetVar("BeglecPrice").AsInt == 0 then
   				AddPlayerMoney(700)
   			else
   				AddPlayerMoney(500)
   			end

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="TriggerFindCircus" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="TheCircus" />
		<script>
   			CompleteQuest( "r1m3_CrazyManQuest" )

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="CARAVANTOR1M4" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("KARAVAN14",1010,CVector(6081, 260, 5915),{"r2m2_CaravanUral02"}, nil, 1)
			local vehP = GetEntityByName("KARAVAN14_vehicle_0")
			if vehP then
				vehP:SetExternalPathByName("karavan_path")
			end

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="triggerExitToMap11" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR1M1" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			local b = SpawnMessageBox( "8801" )
			if b == 1 then

				PassToMap("r1m1", "FromR1M3", -1 )
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 1, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				TActivate ("RolikExitToMap11")
				TActivate ("RolikENDExitToMap11")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap11" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			RotationPlayerByPoints(CVector(getPos("ToR1M1")), CVector(getPos("FromR1M1")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M1")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap11" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M1")))

			TDeactivate( "RolikExitToMap11" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>






	<trigger Name="triggerExitToMap12" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR1M2" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			if IsQuestComplete("d_FindHouseOfBen_Quest") or IsQuestComplete("QuickFindBen") then 
				local b = SpawnMessageBox( "8801" )
				if b == 1 then

					PassToMap("r1m2", "FromR1M3", -1 )
				else
					SaveAllToleranceStatus(RS_NEUTRAL)

					FlyAround(1, 0, 25, 1, PlfCoor, PlfID, 1, 1 )
					StartCinematic()

					TActivate ("RolikExitToMap12")
					TActivate ("RolikENDExitToMap12")
				end
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				AddCinematicMessage( 8802, 0.5 )

				TActivate ("RolikExitToMap12")
				TActivate ("RolikENDExitToMap12")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap12" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			RotationPlayerByPoints(CVector(getPos("ToR1M2")), CVector(getPos("FromR1M2")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M2")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap12" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M2")))

			TDeactivate( "RolikExitToMap12" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>






	<trigger Name="triggerExitToMap14" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR1M4" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			
			local b = SpawnMessageBox( "8801" )
			if b == 1 then
				if IsQuestTaken("d_FindVrata_Quest") or IsQuestTaken("r1m4_TalkWithOldTraderAboutSecondDisk") then

					PassToMap("r1m4", "FromR1M3", -1 )
					local hs = GetEntityByName ("FIRE01")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE02")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE03")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE04")
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE05")	
					if hs then hs:Remove() end
					local hs = GetEntityByName ("FIRE06")
					if hs then hs:Remove() end
					local pavlo = getObj("CrazyRoadRiders")
					if pavlo then pavlo:SetSpokenCount(1) end
					local pogor = getObj("TheCircus")
					if pogor then pogor:SetProperty("Active", 0) end
					TDeactivate("TriggerFindCircus")
				else
					TActivate ("Ending35")
				end
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 3, PlfCoor, PlfID, 1, 1 )
				StartCinematic()
				TActivate ("RolikExitToMap14")
				TActivate ("RolikENDExitToMap14")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap14" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			RotationPlayerByPoints(CVector(getPos("ToR1M4")), CVector(getPos("FromR1M4")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M4")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap14" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR1M4")))

			TDeactivate( "RolikExitToMap14" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>





	<trigger Name="triggerExitToMap21" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ToR2M1" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			if IsQuestTaken("d_OpenTunel_Quest") then 
				local b = SpawnMessageBox( "8801" )
				if b == 1 then

					PassToMap("r2m1", "FromR1M3", -1 )
				else
					SaveAllToleranceStatus(RS_NEUTRAL)

					FlyAround(1, 0, 25, 1, PlfCoor, PlfID, 1, 1 )
					StartCinematic()

					TActivate ("RolikExitToMap21")
					TActivate ("RolikENDExitToMap21")
				end
			else
				SaveAllToleranceStatus(RS_NEUTRAL)

				FlyAround(1, 0, 25, 6, PlfCoor, PlfID, 1, 1 )
				StartCinematic()

				AddCinematicMessage( 8803, 0.5 )

				TActivate ("RolikExitToMap21")
				TActivate ("RolikENDExitToMap21")
			end
 		</script>
	</trigger>
	<trigger Name="RolikExitToMap21" active="0">
		<event eventid="GE_CINEMATIC_ENTER_FADE_IN" ObjName="Player1" />
		<script>
			RotationPlayerByPoints(CVector(getPos("ToR2M1")), CVector(getPos("FromR2M1")))
			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR2M1")))

			trigger:Deactivate()    
		</script>
	</trigger>
	<trigger Name="RolikENDExitToMap21" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()

			GetPlayerVehicle():SetGamePositionOnGround(CVector(getPos("FromR2M1")))

			TDeactivate( "RolikExitToMap21" )

			SetCameraBehindPlayerVehicle()

			trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="ArmiaCreate2" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locArmiaTSP" />
		<script>
		
			SaveAllToleranceStatus(RS_NEUTRAL)
		
   			local vehPlayer = GetPlayerVehicle()
			if vehPlayer then
				vehPlayer:SetCustomControlEnabled( true )
				vehPlayer:SetCustomLinearVelocity( 0 )
				vehPlayer:SetThrottle( 0 )
				vehPlayer:SetCustomControlEnabled( false )
			end
   			
			Fly("Armia_cam01", CINEMATIC_NO_AIM, 0, 20, 1, 1 )
			StartCinematic()
			AddCinematicMessage( 8806, 0.5 )
			AddCinematicMessage( 8807, 0.5 )
			
   			TActivate("ArmiaCreate3")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ArmiaCreate3" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
   			
   			RestoreAllToleranceStatus()

			local veh1 = GetEntityByName("ArmyVeh1")
			if veh1 then veh1:Remove() end
			local veh2 = GetEntityByName("ArmyVeh2")
			if veh2 then veh2:Remove() end
			local veh3 = GetEntityByName("ArmyVeh3")
			if veh3 then veh3:Remove() end


   			
   			local newControllerId1 = CreateNewObject {
				prototypeName	= "someNPCMotionController",
				objName	= "ArmyCont1"
			}

			local newControllerId2 = CreateNewObject {
				prototypeName	= "someNPCMotionController",
				objName	= "ArmyCont2"
			}

			local newControllerId3 = CreateNewObject {
				prototypeName	= "someNPCMotionController",
				objName	= "ArmyCont3"
			}

			local newController1 = GetEntityByID(newControllerId1)
			local newController2 = GetEntityByID(newControllerId2)
			local newController3 = GetEntityByID(newControllerId3)

			TeamCreate("ArmiaTSP",1010,CVector(6018.614, 237.349, 1893.204),{"BelazTSP", "TSPFighter", "tspfighter2"}, CVector(7069.637, 307.696, 1045.202), 1)

			local ArmyVeh1 = GetEntityByName("ArmiaTSP_vehicle_0")
			local ArmyVeh2 = GetEntityByName("ArmiaTSP_vehicle_1")
			local ArmyVeh3 = GetEntityByName("ArmiaTSP_vehicle_2")
			
			if ArmyVeh1 then
				ArmyVeh1:SetRotation(Quaternion(-0.063, 0.206, 0.004, -0.976))
				ArmyVeh1:SetGamePositionOnGround( CVector(6057.330, 238.386, 1933.433))
			end
			
			if ArmyVeh2 then
				ArmyVeh2:SetRotation(Quaternion(-0.001, -0.033, -0.003, -0.999))
				ArmyVeh2:SetGamePositionOnGround( CVector(6027.587, 237.066, 1926.612))
			end
			
			if ArmyVeh3 then
				ArmyVeh3:SetRotation(Quaternion(-0.015, -0.461, 0.090, -0.883))
				ArmyVeh3:SetGamePositionOnGround( CVector(6012.056, 237.713, 1931.321))
			end

			local FVehicle1 = GetEntityByName("ArmiaTSP_vehicle_0")
			local FVehicle2 = GetEntityByName("ArmiaTSP_vehicle_1")
			local FVehicle3 = GetEntityByName("ArmiaTSP_vehicle_2")

			if newController1 and FVehicle1 then
				newController1:setVehicleUnderControl(FVehicle1)
			end

			if newController2 and FVehicle2 then
				newController2:setVehicleUnderControl(FVehicle2)
			end

			if newController3 and FVehicle3 then
				newController3:setVehicleUnderControl(FVehicle3)
			end
   			
   			TeamCreate("Brigada1",1012,CVector(6853.181, 285.306, 1177.337),{"BrigadaCruiser"})
   			TeamCreate("Brigada2",1012,CVector(7056.044, 305.453, 1044.753),{"BrigadaVoz"})
			TeamCreate("ThiefCar",1012,CVector(7080.981, 307.714, 1041.897),{"UralShot"}, nil, 0, Quaternion(-0.042, 0.508, -0.019, -0.860))

			TActivate("TRIGGER_THIEFDIE")
   			
   			CompleteQuest( "Zachisti1_Quest" )
   			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ArmiaCreate" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
		
			local kar = GetEntityByName("KARAVAN14_vehicle_0")
			if kar then
				kar:Remove()
			end
			
			if IsQuestComplete("d_DestroyBridge_Quest") then
--				TeamCreate("ArmiaTSP",1010,CVector(6018.614, 237.349, 1893.204),{"BelazTSP", "TSPFighter", "tspfighter2"})

				CreateVehicleEx( "BelazTSP", "ArmyVeh1", CVector(6057.330, 238.386, 1933.433), 1010 )
				CreateVehicleEx( "TSPFighter", "ArmyVeh2", CVector(6027.587, 237.066, 1926.612), 1010 )
				CreateVehicleEx( "tspfighter2", "ArmyVeh3", CVector(6012.056, 237.713, 1931.321), 1010 )

				local veh1 = GetEntityByName("ArmyVeh1")
				if veh1 then
					veh1:SetRotation(Quaternion(-0.063, 0.206, 0.004, -0.976))
					veh1:setGodMode(1)
				end
				local veh2 = GetEntityByName("ArmyVeh2")
				if veh2 then
					veh2:SetRotation(Quaternion(-0.001, -0.033, -0.003, -0.999))
					veh2:setGodMode(1)
				end
				local veh3 = GetEntityByName("ArmyVeh3")
				if veh3 then
					veh3:SetRotation(Quaternion(-0.015, -0.461, 0.090, -0.883))
					veh3:setGodMode(1)
				end

				TActivate( "ArmiaCreate2" )
			end
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Chehol_Find" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Chehly_loc" />
		<script>
			local Plf = GetPlayerVehicle()
			local PlfID = GetPlayerVehicleId()
			local PlfCoor = Plf:GetPosition()
			PlfCoor.y = PlfCoor.y + 25*0.74
			PlfCoor.z = PlfCoor.z + 25*0.74

			Plf:SetCustomLinearVelocity(0)
			Plf:SetThrottle(0)

			SaveAllToleranceStatus(RS_NEUTRAL)

			FlyAround(6, 0, 25, 8, PlfCoor, PlfID, 1, 1 )
			StartCinematic()
			AddCinematicMessage( 8809, 0.25 )
			
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_chehly_box")
			
			CompleteQuest("d_chehol2")

			
	
			AddQuestItem("quest_chehly_box")

			TActivate("Chehol_Find_End")

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="Chehol_Find_End" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
		local rrr = GetEntityByName ("chehly_box")
		if rrr then rrr:Remove() end

		RestoreAllToleranceStatus()

		trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Chehol_1" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Chehly1_loc" />
		<script>
			SetTolerance(1100,1012,RS_ENEMY)
			
			SaveAllToleranceStatus(RS_NEUTRAL)
			
			CreateNewDummyObject( "parsel", "chehly_box", -1, -1, CVector(1560.871, 260.885, 3984.221), Quaternion(0.0000, -0.9490, 0.0000, 0.3152), 0)
			
			PlayCustomMusic("Bio02")
			
			CompleteQuest("d_chehol1")
			
			Fly("Chehly_cam1", CINEMATIC_NO_AIM, 0, 11, 1, 1 )
			StartCinematic()
			
			GetPlayerVehicle():SetCustomLinearVelocity( 0 )
			GetPlayerVehicle():SetThrottle( 0 )
			
			AddCinematicMessage( 8808, 1 )
			
			TActivate("Chehol_Find")
			TActivate("Chehol_End")

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="Chehol_End" active="0">
		<event eventid="GE_END_CINEMATIC" ObjName="Player1" />
		<event eventid="GE_SKIP_CINEMATIC" ObjName="Player1" />
		<script>
			RestoreAllToleranceStatus()
			
			StopPlayingCustomMusic()
			
			TeamCreate("CheholFighters",1012,CVector(1947.328, 270.788, 3980.524),{"MolokovozChehol", "Cruiser02", "BelazTSPP"})
			local vehBrig1 = GetEntityByName("CheholFighters_vehicle_0")
			local vehBrig2 = GetEntityByName("CheholFighters_vehicle_1")
			local vehBrig3 = GetEntityByName("CheholFighters_vehicle_2")
			if vehBrig1 then
				vehBrig1:SetRotation(Quaternion(-0.005, 0.953, 0.003, 0.302))
				vehBrig1:SetGamePositionOnGround( CVector(1947.328, 270.788, 3980.524))
			end
			if vehBrig2 then
				vehBrig2:SetRotation(Quaternion(0.002, -0.607, 0.014, -0.794))
				vehBrig2:SetGamePositionOnGround( CVector(1553.049, 264.343, 4023.615))
			end
			if vehBrig3 then
				vehBrig3:SetRotation(Quaternion(0.003, 0.960, 0.000, 0.279))
				vehBrig3:SetGamePositionOnGround( CVector(1635.032, 259.942, 3990.873))
			end
			
			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="StartNormalEnd" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locNormalEnd" />
		<script>
		if IsQuestComplete("BenNormalEnd") then
			TActivate("NormalEndCin")
			trigger:Deactivate()
		end
		</script>
	</trigger>

	<trigger Name="trFightForPesht" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="locFightForPesht" />
		<script>
			TActivate("cinFightForPesht")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trZasadaAR" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ZasadaAR_loc" />
		<script>
			local stat = GetVar("ZasadaAR").AsInt
			if stat==1 and IsQuestComplete("d_GetSupportOneOfTheBands1_Quest") then
				local vehPlayer = GetPlayerVehicle()
				if vehPlayer then
					vehPlayer:SetCustomControlEnabled( true )
					vehPlayer:SetCustomLinearVelocity( 0 )
					vehPlayer:SetThrottle( 0 )
					vehPlayer:SetCustomControlEnabled( false )
				end
				
				TActivate("RolikZasadaARStart")
				
				trigger:Deactivate()
			end
		</script>
	</trigger>

	<trigger Name="trZasadaAR_Delete" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>
			local zas1 = GetEntityByName("ZasadaAR1")
			local zas2 = GetEntityByName("ZasadaAR2")
			if zas1 then
				zas1:Remove()
			end
			
			if zas2 then
				zas2:Remove()
			end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trZasadaAR_Create" active="0">
		<event	timeout="0.01"		eventid="GE_TIME_PERIOD" />
		<script>
			local zas1 = GetEntityByName("ZasadaAR1")
			local zas2 = GetEntityByName("ZasadaAR2")
			if zas1 then
				zas1:Remove()
			end
			
			if zas2 then
				zas2:Remove()
			end
			
			TeamCreate("ZasadaARTeam",1015,CVector(1798.483, 279.056, 5487.830),{"Cruiser01", "CoolBelaz_2"})
			
			TActivate("trZasadaAR_Dead")
			
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trZasadaAR_Dead" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="ZasadaARTeam" />
		<script>
			SetTolerance(1100,1015,RS_ALLY)
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trQuickWay" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="QuickWay_loc" />
		<script>
			SetVar("QuickWay",1)
			
			if QuestStatus("d_GiveMoneyToBase_Quest")==Q_CANBEGIVEN then
				TakeQuest("d_GiveMoneyToBase_Quest")
				FailQuest("d_GiveMoneyToBase_Quest")
			end
			
			TActivate ("tr_OpenTownAndShowButtonInPesht")
			
			FailQuestIfTaken("d_RideAcrossBase_Quest")
			FailQuestIfTaken("d_GiveMoneyToBase_Quest")
			FailQuestIfTaken("d_GetBomb_Quest")
			FailQuestIfTaken("d_DestroyBridge_Quest")

			TDeactivate("preBOOOM")
			TDeactivate("BOOOM")
			TDeactivate("SHAHTSBANDITBOSSDIE")

			CompleteQuestIfTaken("d_MoveToPesht_Quest")
			trigger:Deactivate()
		</script>
	</trigger>

</triggers>